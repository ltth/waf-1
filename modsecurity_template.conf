# -- Rule engine initialization ----------------------------------------------

# Enable ModSecurity, attaching it to every transaction. Use detection
# only to start with, because that minimises the chances of post-installation
# disruption.
#
#SecRuleEngine DetectionOnly
#SecRuleEngine On
#SecRuleEngine Off

# -- Request body handling ---------------------------------------------------

# Allow ModSecurity to access request bodies. If you don't, ModSecurity
# won't be able to see any POST parameters, which opens a large security
# hole for attackers to exploit.
#
#SecRequestBodyAccess On

# Enable XML request body parser.
# Initiate XML Processor in case of xml content-type
#
#SecRule REQUEST_HEADERS:Content-Type "text/xml" \
#     "id:'20000000',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=XML"

# Enable JSON request body parser.
# Initiate JSON Processor in case of JSON content-type; change accordingly
# if your application does not use 'application/json'
#
#SecRule REQUEST_HEADERS:Content-Type "application/json" \
#     "id:'20000001',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=JSON"

# Maximum request body size we will accept for buffering. If you support
# file uploads then the value given on the first line has to be as large
# as the largest file you are willing to accept. The second value refers
# to the size of data, with files excluded. You want to keep that value as
# low as practical.
#
#SecRequestBodyLimit 838860800
#SecRequestBodyNoFilesLimit 131072

# Store up to 128 KB of request body data in memory. When the multipart
# parser reachers this limit, it will start using your hard disk for
# storage. That is slow, but unavoidable.
#
SecRequestBodyInMemoryLimit 131072

# What do do if the request body size is above our configured limit.
# Keep in mind that this setting will automatically be set to ProcessPartial
# when SecRuleEngine is set to DetectionOnly mode in order to minimize
# disruptions when initially deploying ModSecurity.
#
#SecRequestBodyLimitAction Reject

# Verify that we've correctly processed the request body.
# As a rule of thumb, when failing to process a request body
# you should reject the request (when deployed in blocking mode)
# or log a high-severity alert (when deployed in detection-only mode).
#
#SecRule REQBODY_ERROR "!@eq 0" \
#"id:'200002', phase:2,t:none,log,deny,status:400,msg:'Failed to parse request body.',logdata:'%{reqbody_error_msg}',severity:2"

# By default be strict with what we accept in the multipart/form-data
# request body. If the rule below proves to be too strict for your
# environment consider changing it to detection-only. You are encouraged
# _not_ to remove it altogether.
#
#SecRule MULTIPART_STRICT_ERROR "!@eq 0" \
#"id:'200003',phase:2,t:none,log,deny,status:400, \
#msg:'Multipart request body failed strict validation: \
#PE %{REQBODY_PROCESSOR_ERROR}, \
#BQ %{MULTIPART_BOUNDARY_QUOTED}, \
#BW %{MULTIPART_BOUNDARY_WHITESPACE}, \
#DB %{MULTIPART_DATA_BEFORE}, \
#DA %{MULTIPART_DATA_AFTER}, \
#HF %{MULTIPART_HEADER_FOLDING}, \
#LF %{MULTIPART_LF_LINE}, \
#SM %{MULTIPART_MISSING_SEMICOLON}, \
#IQ %{MULTIPART_INVALID_QUOTING}, \
#IP %{MULTIPART_INVALID_PART}, \
#IH %{MULTIPART_INVALID_HEADER_FOLDING}, \
#FL %{MULTIPART_FILE_LIMIT_EXCEEDED}'"

# Did we see anything that might be a boundary?
#
#SecRule MULTIPART_UNMATCHED_BOUNDARY "!@eq 0" \
#"id:'200004',phase:2,t:none,log,deny,msg:'Multipart parser detected a possible unmatched boundary.'"

# PCRE Tuning
# We want to avoid a potential RegEx DoS condition
#
#SecPcreMatchLimit 5000
#SecPcreMatchLimitRecursion 5000

# Some internal errors will set flags in TX and we will need to look for these.
# All of these are prefixed with "MSC_".  The following flags currently exist:
#
# MSC_PCRE_LIMITS_EXCEEDED: PCRE match limits were exceeded.
#
#SecRule TX:/^MSC_/ "!@streq 0" \
#       "id:'200005',phase:2,t:none,deny,msg:'ModSecurity internal error flagged: %{MATCHED_VAR_NAME}'"


# -- Response body handling --------------------------------------------------

# Allow ModSecurity to access response bodies. 
# You should have this directive enabled in order to identify errors
# and data leakage issues.
# 
# Do keep in mind that enabling this directive does increases both
# memory consumption and response latency.
#
#SecResponseBodyAccess On
#SecResponseBodyAccess Off

# Which response MIME types do you want to inspect? You should adjust the
# configuration below to catch documents but avoid static files
# (e.g., images and archives).
#
#SecResponseBodyMimeType text/plain text/html text/xml

# Buffer response bodies of up to 512 KB in length.
SecResponseBodyLimit 524288

# What happens when we encounter a response body larger than the configured
# limit? By default, we process what we have and let the rest through.
# That's somewhat less secure, but does not break any legitimate pages.
#
SecResponseBodyLimitAction ProcessPartial


# -- Filesystem configuration ------------------------------------------------

# The location where ModSecurity stores temporary files (for example, when
# it needs to handle a file upload that is larger than the configured limit).
# 
# This default setting is chosen due to all systems have /tmp available however, 
# this is less than ideal. It is recommended that you specify a location that's private.
#
SecTmpDir /tmp/

# The location where ModSecurity will keep its persistent data.  This default setting 
# is chosen due to all systems have /tmp available however, it
# too should be updated to a place that other users can't access.
#
#SecDataDir /tmp/


# -- File uploads handling configuration -------------------------------------

# The location where ModSecurity stores intercepted uploaded files. This
# location must be private to ModSecurity. You don't want other users on
# the server to access the files, do you?
#
#SecUploadDir /opt/modsecurity/var/upload/

# By default, only keep the files that were determined to be unusual
# in some way (by an external inspection script). For this to work you
# will also need at least one file inspection rule.
#
#SecUploadKeepFiles RelevantOnly

# Uploaded files are by default created with permissions that do not allow
# any other user to access them. You may need to relax that if you want to
# interface ModSecurity to an external program (e.g., an anti-virus).
#
#SecUploadFileMode 0600


# -- Debug log configuration -------------------------------------------------

# The default debug log configuration is to duplicate the error, warning
# and notice messages from the error log.
#
#SecDebugLog /opt/modsecurity/var/log/debug.log
#SecDebugLogLevel 3


# -- Audit log configuration -------------------------------------------------

# Log the transactions that are marked by a rule, as well as those that
# trigger a server error (determined by a 5xx or 4xx, excluding 404,  
# level response status codes).
#
SecAuditEngine RelevantOnly
SecAuditLogRelevantStatus "^(?:5|4(?!08))"

# Log everything we know about a transaction.
SecAuditLogParts ABIJDEFHZ

# Use a single file for logging. This is much easier to look at, but
# assumes that you will use the audit log only ocassionally.
#
#SecAuditLogType Serial
#SecAuditLog /opt/waf/logs/mod_security.log
#SecAuditLog "|/usr/local/bin/mlogc /etc/mlogc.conf"

#SecAuditLogType Concurrent

# Specify the path for concurrent audit logging.
SecAuditLogStorageDir /opt/waf/logs/audit
SecAuditLogDirMode 0777
SecAuditLogFileMode 0550
SecAuditLogType Concurrent

# -- Miscellaneous -----------------------------------------------------------

# Use the most commonly used application/x-www-form-urlencoded parameter
# separator. There's probably only one application somewhere that uses
# something else so don't expect to change this value.
#
SecArgumentSeparator &

# Settle on version 0 (zero) cookies, as that is what most applications
# use. Using an incorrect cookie version may open your installation to
# evasion attacks (against the rules that examine named cookies).
#
SecCookieFormat 0

# Specify your Unicode Code Point.
# This mapping is used by the t:urlDecodeUni transformation function
# to properly map encoded data to your language. Properly setting
# these directives helps to reduce false positives and negatives.
#
#SecUnicodeMapFile unicode.mapping 20127

# Improve the quality of ModSecurity by sharing information about your
# current ModSecurity version and dependencies versions.
# The following information will be shared: ModSecurity version,
# Web Server version, APR version, PCRE version, Lua version, Libxml2
# version, Anonymous unique id for host.
SecStatusEngine Off

SecCollectionTimeout 600

SecAction \
 "id:900990,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.crs_setup_version=302"

SecRule &TX:crs_setup_version "@eq 0" \
    "id:901001,\
    phase:1,\
    auditlog,\
    log,\
    deny,\
    status:500,\
    severity:CRITICAL,\
    msg:'ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions.'"

SecRule &TX:paranoia_level "@eq 0" \
    "id:901120,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.paranoia_level=1"

SecRule &TX:sampling_percentage "@eq 0" \
    "id:901130,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.sampling_percentage=100"

SecRule &TX:critical_anomaly_score "@eq 0" \
    "id:901140,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.critical_anomaly_score=5"

SecRule &TX:error_anomaly_score "@eq 0" \
    "id:901141,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.error_anomaly_score=4"

SecRule &TX:warning_anomaly_score "@eq 0" \
    "id:901142,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.warning_anomaly_score=3"

SecRule &TX:notice_anomaly_score "@eq 0" \
    "id:901143,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.notice_anomaly_score=2"

# Default do_reput_block
SecRule &TX:do_reput_block "@eq 0" \
    "id:901150,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.do_reput_block=0"

# Default block duration
SecRule &TX:reput_block_duration "@eq 0" \
    "id:901152,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.reput_block_duration=300"

# Default HTTP policy: allowed_methods (rule 900200)
SecRule &TX:allowed_methods "@eq 0" \
    "id:901160,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.allowed_methods=GET HEAD POST OPTIONS'"

# Default HTTP policy: allowed_request_content_type (rule 900220)
SecRule &TX:allowed_request_content_type "@eq 0" \
    "id:901162,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded|multipart/form-data|text/xml|application/xml|application/soap+xml|application/x-amf|application/json|application/octet-stream|text/plain'"

# Default HTTP policy: allowed_http_versions (rule 900230)
SecRule &TX:allowed_http_versions "@eq 0" \
    "id:901163,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0'"

# Default HTTP policy: restricted_extensions (rule 900240)
SecRule &TX:restricted_extensions "@eq 0" \
    "id:901164,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/ .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/ .xsx/'"

# Default HTTP policy: restricted_headers (rule 900250)
SecRule &TX:restricted_headers "@eq 0" \
    "id:901165,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.restricted_headers=/proxy/ /lock-token/ /content-range/ /translate/ /if/'"

# Default HTTP policy: static_extensions (rule 900260)
SecRule &TX:static_extensions "@eq 0" \
    "id:901166,\
    phase:1,\
    pass,\
    nolog,\
    setvar:'tx.static_extensions=/.jpg/ /.jpeg/ /.png/ /.gif/ /.js/ /.css/ /.ico/ /.svg/ /.webp/'"


#
# -=[ Initialize internal variables ]=-
#

# Initialize anomaly scoring variables.
# All _score variables start at 0, and are incremented by the various rules
# upon detection of a possible attack.
# sql_error_match is used for shortcutting rules for performance reasons.

SecAction \
 "id:901200,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.anomaly_score=0,\
  setvar:tx.sql_injection_score=0,\
  setvar:tx.xss_score=0,\
  setvar:tx.rfi_score=0,\
  setvar:tx.lfi_score=0,\
  setvar:tx.rce_score=0,\
  setvar:tx.php_injection_score=0,\
  setvar:tx.http_violation_score=0,\
  setvar:tx.session_fixation_score=0,\
  setvar:tx.inbound_anomaly_score=0,\
  setvar:tx.outbound_anomaly_score=0,\
  setvar:tx.sql_error_match=0,\
  setvar:tx.restrict_rule=0"


#
# -=[ Initialize collections ]=-
#
# Create both Global and IP collections for rules to use.
# There are some CRS rules that assume that these two collections
# have already been initiated.
#

SecRule REQUEST_HEADERS:User-Agent "^(.*)$" \
  "id:901318, \
  phase:1, \
  t:none,t:sha1,t:hexEncode, \
  setvar:tx.ua_hash=%{matched_var}, \
  nolog, \
  pass"

SecAction \
  "id:901321, \
  phase:1, \
  t:none, \
  initcol:global=global, \
  initcol:ip=%{remote_addr}_%{tx.ua_hash}, \
  setvar:tx.real_ip=%{remote_addr}, \
  nolog, \
  pass"

SecRule TX:sampling_percentage "@eq 100" \
	"id:901400,\
	phase:1,\
	pass,\
	nolog,\
	skipAfter:END-SAMPLING"

SecRule UNIQUE_ID "@rx ^." \
	"id:901410,\
	phase:1,\
	pass,\
	nolog,\
	t:sha1,\
	t:hexEncode,\
	setvar:TX.sampling_rnd100=%{MATCHED_VAR}"

SecRule DURATION "@rx (..)$" \
	"id:901420,\
	phase:1,\
	pass,\
	capture,\
	nolog,\
	setvar:TX.sampling_rnd100=%{TX.sampling_rnd100}%{TX.1}"

SecRule TX:sampling_rnd100 "@rx ^[a-f]*([0-9])[a-f]*([0-9])" \
	"id:901430,\
	phase:1,\
	pass,\
	nolog,\
	capture,\
	setvar:TX.sampling_rnd100=%{TX.1}%{TX.2}"

SecRule TX:sampling_rnd100 "@rx ^0([0-9])" \
	"id:901440,\
	phase:1,\
	pass,\
	capture,\
	nolog,\
	setvar:TX.sampling_rnd100=%{TX.1}"

SecRule TX:sampling_rnd100 "!@lt %{tx.sampling_percentage}" \
	"id:901450,\
	phase:1,\
	pass,\
	log,\
	noauditlog,\
	ctl:ruleEngine=off,\
	msg:'Sampling: Disable the rule engine based on sampling_percentage \
%{TX.sampling_percentage} and random number %{TX.sampling_rnd100}.'"

SecMarker "END-SAMPLING"

###comodo init setup:
SecRule REQUEST_COOKIES:PHPSESSID "!@rx ^$" \
	"id:5000020,msg:'VIETTEL WAF: start track phpsession',phase:2,capture,pass,setsid:'%{MATCHED_VAR}',nolog,rev:11,severity:2,tag:'VTWAF',tag:'AppsInitialization'"

SecRule REQUEST_COOKIES_NAMES "@rx ^wordpress_([0-9a-fA-f]{32})$" \
	"id:5000021,msg:'VIETTEL WAF: Start track session id',phase:2,capture,pass,setsid:'%{TX.1}',setvar:'SESSION.wp_session=1',setvar:'TX.WordPress=1',expirevar:'SESSION.wp_session=300',nolog,rev:11,severity:2,tag:'VTWAF',tag:'AppsInitialization'"

SecRule REQUEST_COOKIES:MoodleSession "!@rx ^$" \
	"id:5000022,msg:'VIETTEL WAF: start track MoodleSession',phase:2,capture,pass,setsid:'%{MATCHED_VAR}',setvar:'SESSION.moodlesession=%{MATCHED_VAR}',nolog,rev:11,severity:2,tag:'VTWAF',tag:'AppsInitialization'"

SecRule &SESSION:joomla_session "@eq 0" \
	"id:5000023,chain,msg:'VIETTEL WAF: Start tracking Joomla! session',phase:2,pass,nolog,t:none,rev:11,severity:2,tag:'VTWAF',tag:'AppsInitialization'"
SecRule REQUEST_COOKIES:/^[a-f0-9]{32}$/ "@rx ^(?:[a-z0-9]{26}|[a-z0-9]{32})$" \
	"setsid:'%{MATCHED_VAR}',setvar:'SESSION.joomla_session=1',expirevar:'SESSION.joomla_session=3600',t:none"

SecRule REQUEST_COOKIES_NAMES "@rx ^sess([0-9a-f]{32})$" \
	"id:5000024,msg:'VIETTEL WAF: Drupal App Initialization',phase:2,capture,pass,setsid:'%{TX.1}',setvar:'TX.drupal=1',setvar:'SESSION.drupal=1',expirevar:'SESSION.drupal=300',nolog,t:none,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'AppsInitialization'"

SecAction \
	"id:5000025,phase:2,pass,setvar:'tx.xmlrpc_watch_period=300',setvar:'tx.xmlrpc_requests_limit=5',setvar:'tx.xmlrpc_block_timeout=600',nolog"

####################BEGIN GLOBAL RULE#####################
SecRule ARGS:action "@streq parse-media-shortcode" \
	"id:5000010,chain,msg:'SQL Injection Vulnerability in Plugin WP Statistics',phase:2,deny,status:403,log,t:none,t:lowercase,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"chain,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase"
SecRule ARGS:shortcode "@rx [^\w\ \.\=\[\]]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule ARGS:task "@rx login" \
	"id:5002592,chain,msg:'LDAP Information Disclosure (CVE-2017-14596)',phase:2,deny,status:403,log,t:none,t:lowercase,rev:4,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:username "@rx [\\\\<>\"\'\%\;\(\)\&]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Content-Type "(application|text)/xml" "id:'5001653',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=URLENCODED"

SecRule REQUEST_HEADERS:Content-Type "@rx (application|text)/xml" \
	"id:5001654,chain,msg:'Remote code execution vulnerability in Apache Struts (CVE-2017-9805, CVE-2013-7285)',phase:2,deny,status:403,log,t:none,t:lowercase,rev:6,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule REQUEST_BODY "@contains java.lang.ProcessBuilder" \
	"chain,t:none"
SecRule REQUEST_BODY "@rx (jdk\.nashorn\.internal\.objects\.NativeString|java\.beans\.EventHandler|groovy\.util\.Expando)" \
	"t:none,setvar:tx.restrict_rule=1"
# require SecStreamInBodyInspection On
SecRule STREAM_INPUT_BODY|ARGS_NAMES|ARGS "@rx (ognlUtil\.getExcludedPackageNames\(\)|ognlUtil\.getExcludedClasses\(\))" \
	"id:5001655,msg:'Remote code execution vulnerability in FreeMaker in Apache Struts (CVE-2017-12611)',phase:2,deny,status:403,log,t:none,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx ^(method:|action:).*(\(|\\\\|(\$\{)|(\%\{))" \
	"id:5002575,msg:'Remote command execution vulnerability in Apache Struts version between 2.3.20 and 2.3.28 (except 2.3.20.2 and 2.3.24.2). Remote Code Execution can be performed via method: prefix when Dynamic Method Invocation is enabled (CVE-2016-3081)',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:lowercase,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx ^(redirectaction:|action:|redirect:).*(\(|\\\\|(\$\{)|(\%\{))" \
	"id:5002581,msg:'A vulnerability introduced by manipulating parameters prefixed with action:/redirect:/redirectAction: allows remote command execution (CVE-2013-2251)',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:lowercase,rev:4,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "(?i:((\".*?\\\\\"\s+?.*?\s*?\"\s*?@)|(-OQueueDirectory\=.+?\s+?-X.+?\.php)))" "phase:2,rev:4,t:none,t:urlDecodeUni,log,deny,status:403,msg:'PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)',id:5000007,logdata:'Found data matched %{matched_var}',severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PHPMailer',setvar:tx.restrict_rule=1"
SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "(?i:(\\\".*?\\\\\'\s+?.*?\s*?\"\s*?@))" "phase:2,rev:3,t:none,t:urlDecodeUni,log,deny,status:403,msg:'PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)',id:5000008,logdata:'Found data matched %{matched_var}',severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PHPMailer',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:((\/Telerik\.Web\.UI\.DialogHandler\.as(p|h)x)|(\/DesktopModules\/Admin\/RadEditorProvider\/DialogHandler\.as(p|h)x)))" \
	"id:5000009,msg:'A cryptographic weakness in Telerik.Web.UI.dll (CVE-2017-9248)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:4,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Telerik',setvar:tx.restrict_rule=1"
SecRule REQUEST_METHOD "@rx ^(?i:PUT)$" \
	"id:5002591,chain,msg:'CVE-2017-12615 Apache Tomcat Remote Code Execution via JSP upload',phase:2,rev:4,t:none,t:urlDecodeUni,log,deny,status:403,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Tomcat'"
SecRule REQUEST_FILENAME "@rx (?i:\.(php.?|asp|aspx|asa|asax|ascx|ashx|asmx|soap|cs|inc|jsp|jspf|jspx|java|html|htmlx|phtml|cfg|cfm|htaccess|cgi|dll|exe|bat|sh|py|pl|cer|war)(\.| |\/|\\\\|\:\:\$DATA))" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_METHOD "@rx ^(?i:PATCH)$" \
	"id:5002593,chain,msg:'RCE in PATCH requests in Spring Data REST (CVE-2017-8046)',phase:2,rev:2,t:none,log,deny,status:403,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Tomcat',tag:'Spring '"
SecRule REQUEST_HEADERS:Content-Type "@rx application\/json\-patch\+json" \
	"chain,t:none"
SecRule ARGS:path "@rx [\(\)]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:if "(?i:(^<http(s?):))" "phase:2,rev:2,t:none,t:urlDecodeUni,log,deny,msg:'IIS 6.0 Buffer Overflow vulnerability (CVE-2017-7269)',id:5000000,logdata:'Found %{matched_var} in header',severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',setvar:tx.restrict_rule=1"
SecRule ARGS:javax.faces.ViewState "@gt 100" "id:5000001,phase:2,t:length,ctl:ruleEngine=On,deny,log,status:403,msg:'Blocked a attack request to Oracle ADF Framework',rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',setvar:tx.restrict_rule=1"
SecRule FILES "@rx (?i:\.(php.?|phar|asp|aspx|asa|asax|ascx|ashx|asmx|soap|cs$|inc|jsp|jspf|jspx|java|html|htmlx|shtml|phtml|cfg|cfm|htaccess|cgi|dll|exe|bat|sh|py|pl|cer|war))" "phase:2,rev:11,t:none,t:urlDecodeUni,log,deny,status:403,msg:'Block upload file php.|phar|asp|aspx|asa|asax|ascx|ashx|asmx|soap|cs|inc|jsp|jspf|jspx|java|html|htmlx|shtml|phtml|cfg|cfm|htaccess|cgi|dll|exe|bat|sh|py|pl|cer|war',id:5000003,logdata:'Found Extension %{matched_var}',severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',setvar:tx.restrict_rule=1"
#Require SecStreamInBodyInspection On
SecRule REQUEST_FILENAME "@rx service\/soap|service\/admin\/soap|autodiscover" \
	"chain,id:5000011,msg:'Deny XXE Zimbra payload',phase:2,deny,log,status:403,t:lowercase,t:urlDecodeUni,t:normalizePathWin,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'XXE',tag:'ZIMBRA'" 
SecRule STREAM_INPUT_BODY "@rx <!doctype|http:\/\/www\.w3\.org\/2001\/xinclude|http:\/\/www\.w3\.org\/1999\/xsl\/transform|http:\/\/www\.w3\.org\/2001\/xmlschema" \
	"t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx (?i:(^\/wp-content\/plugins\/captcha\/plugin-update\.php))" \
	"id:5002607,msg:'Backdoor in Captcha Plugin (4.3.6 - 4.4.4)',phase:2,t:none,t:urlDecodeUni,t:normalizePathWin,deny,log,status:403,rev:1,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:((\/wls-wsat\/CoordinatorPortType)|(\/wls-wsat\/CoordinatorPortType11)|(\/wls-wsat\/CoordinatorPortType12)))" \
	"id:5002608,msg:'Deserialization vulnerability in Oracle WebLogic Server WLS Security component (wls-wsat.war) lead to RCE (XmlDecoder Deserialization) (CVE-2017-10271)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WebLogic',setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Cookie "@contains DNNPersonalization" \
    "id:5002611,msg:'DNN (aka DotNetNuke) before 9.1.1 has Remote Code Execution via a cookie (CVE-2017-9822)',phase:2,deny,chain,status:403,log,t:urlDecode,t:none,t:trim,rev:2,severity:2,tag:'CWAF',tag:'VTWAF_MONITOR_VUL',tag:'DotNetNuke'"
SecRule REQUEST_HEADERS:Cookie "@contains <MethodName>" \
    "t:none,t:trim,t:urlDecode"
SecRule ARGS:routestring "@rx \\\\" \
	"id:5002609,msg:'vBulletin routestring Unauthenticated Remote Code Execution',phase:2,t:none,t:urlDecodeUni,deny,log,status:403,rev:1,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'vBulletin',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:(\/ajax\/api\/template\/cacheTemplates))" \
	"id:5002610,chain,msg:'vBulletin cacheTemplates Unauthenticated Remote Arbitrary File Deletion (CVE-2017-17672)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'vBulletin'"
SecRule ARGS:templateidlist "@contains O:" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:(\/Telerik\.Web\.UI\.WebResource\.axd))" \
	"id:5002615,chain,msg:'A weakness in Telerik.Web.UI.dll allows remote attackers to perform arbitrary file uploads or execute arbitrary code (CVE-2017-11317)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Telerik'"
SecRule ARGS:type "@contains rau" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS "@rx [<][?]php.\@eval[(]\$_POST.*[)];[?][>]|[<]\%\@\sPage\sLanguage=.Jscript.\%[>][<]\%eval.Request\.Item.+unsafe"\
		"id:5002616,\
		msg:'Detect request try to inject Chopper web shell',\
		deny,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'chopper',\
		t:none,\
		t:trim,\
		setvar:tx.restrict_rule=1"
SecRule ARGS_POST "@rx (?i)FromBase64String"\
		"id:5002617,\
		msg:'Detect Chopper web shell was sending A attacking payload',\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'chopper',\
		t:none,\
		t:trim,\
        t:lowercase"
		
SecRule ARGS_POST_NAMES "(?i)z1"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@rx (\${.*})" \
	"id:5002754,msg:'VT-2018-02890 RCE in Struts 2.3 - Struts 2.3.34, Struts 2.5 - Struts 2.5.16 (S2-057)',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /_vti_bin/webpartpages.asmx" \
	"id:5002755,msg:'VT-2018-02894 Set request body processor to be URLENCODED',phase:1,pass,nolog,t:none,t:lowercase,t:normalizePathWin,ctl:requestBodyProcessor=URLENCODED,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'SharePoint'"

SecRule REQUEST_FILENAME "@contains /_vti_bin/webpartpages.asmx" \
	"id:5002756,chain,msg:'VT-2018-02894 Bypassing Workflows Protection Mechanisms - Remote Code Execution on SharePoint (CVE-2018-8284)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'SharePoint'"
SecRule REQUEST_BODY "@rx (?i:(<.*?Code.*?>.*?</.*?Code.*?>))" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx [\\\/][^\\\/]*\.swp" \
	"id:5002757,msg:'VT-2018-02895 Read swap file VIM',phase:1,deny,status:403,log,t:none,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'VIM'"
SecRule REQUEST_URI "@rx (?i:(^\/wp-admin\/upload\.php))" \
	"id:5002594,chain,msg:'SQL injection in WordPress before 4.8.2 (CVE-2017-14723)',phase:2,t:none,t:urlDecodeUni,t:normalizePathWin,deny,log,status:403,rev:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@streq delete" \
	"chain,t:none,t:lowercase"
SecRule ARGS:/^media/ "@rx [^\[\]0-9\.\,]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"id:5002595,chain,msg:'Path traversal vulnerability in WordPress Core Ajax handlers - WordPress 4.5.3 (CVE-2016-6896)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@streq update-plugin" \
	"chain,t:none,t:lowercase"
SecRule ARGS:plugin "@rx ((\.\/\.\.\/)|(\.\\\\\.\.\\\\)|(\.\/\.\.\\\\)|(\.\\\\\.\.\/))" \
	"t:none,t:lowercase,t:normalizePath,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /administrator/components/com_joomlaupdate/restore.php" \
	"id:5002596,chain,msg:'PHP Object Injection in Akeeba Restore in Joomla before 3.3.5 (CVE-2014-7228)',phase:2,deny,status:403,t:none,t:urlDecodeUni,t:lowercase,t:normalizePathWin,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS_NAMES "@streq factory" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS:option "@streq com_media" \
	"id:5002597,chain,msg:'Joomla! before 3.6.5 allows users to upload and execute files with the `.php6`, `.php7`, and `.phpt` extensions  (CVE-2016-9836)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq file.upload" \
	"chain,t:none,t:trim,t:lowercase"
SecRule FILES "@rx \.(php(6|7|t(ml)?))\.*$" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@streq xslt.location" \
	"id:5002599,msg:'XSLTResult in Apache Struts 2.x before 2.3.20.2, 2.3.24.x before 2.3.24.2, and 2.3.28.x before 2.3.28.1 allows remote attackers to execute arbitrary code via the stylesheet location parameter (CVE-2016-3082)',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_BASENAME "@rx \!.*(\(|\\\\)" \
	"id:5002600,msg:'Apache Struts 2.3.20.x before 2.3.20.3, 2.3.24.x before 2.3.24.3, and 2.3.28.x before 2.3.28.1, when Dynamic Method Invocation is enabled, allow remote attackers to execute arbitrary code via vectors related to an ! (exclamation mark) operator to the REST Plugin (CVE-2016-3087)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx (\[\(|\(\[|\]\(|\)\])" \
	"id:5002601,chain,msg:'ParameterInterceptor vulnerability allows remote command execution (CVE-2011-3923)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,rev:3,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule ARGS "@contains xwork.methodaccessor.denymethodexecution" \
	"t:none,t:urlDecodeuni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES:/\\\\u0023/ "@gt 50" \
	"id:5002602,msg:'The vulnerability allows a malicious user to bypass the #-usage protection built into the ParametersInterceptor, thus being able to manipulate server side context objects (S2-003)(CVE-2008-6504)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:lowercase,t:length,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@contains product_video/product_gallery/retrieveimage/key" \
	"id:5002603,chain,msg:'RCE in video upload(APPSEC-1626)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"
SecRule ARGS:remote_image "@rx \.htaccess" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@contains /rest" \
	"id:5002604,phase:1,ctl:forceRequestBodyVariable=On,t:none,tag:'VTWAF',tag:'Magento'"

SecRule REQUEST_URI "@contains /rest" \
	"id:5002605,chain,msg:'Magento CE and EE before 2.0.6 allows remote attackers to conduct PHP objection injection attacks and execute arbitrary PHP code via crafted serialized shopping cart data. (CVE-2016-4010)',phase:2,deny,status:403,log,t:none,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"
SecRule REQUEST_BODY "@contains additional_data" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_BODY "@rx O:\+?\d+:." \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/index\.php" \
	"id:5002612,chain,msg:'Joomla! Component Joomanager 2.0.0 - Arbitrary File Download',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq download" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:path "!@rx \.(jpg|png|gif|css|js)$" \
	"t:none,t:urlDecodeUni,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (/invoker/jmxinvokerservlet|/invoker/ebjinvokerservlet)" "id:5002618,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'JBoss',t:none,t:lowercase,t:normalizePathWin,msg:'VT-2018-02873-JBoss HttpAdaptor JMXInvokerServlet (CVE-2012-0874,CVE-2013-4810)',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /jmx-console/htmladaptor" "id:5002619,chain,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'JBoss',t:none,t:lowercase,t:normalizePathWin,msg:'VT-2018-02872-JBoss JMX management console (MainDeployer)'
SecRule ARGS:action "@streq invokeop" "chain,t:none,t:lowercase"
SecRule ARGS:methodIndex "@streq 19" "t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains /jmx-console/htmladaptor" "id:5002620,chain,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'JBoss',t:none,t:lowercase,t:normalizePathWin,msg:'VT-2018-02872-JBoss JMX management console (DeploymentFileRepository)'
SecRule ARGS:action "@streq invokeopbyname" "chain,t:none,t:lowercase"
SecRule ARGS:methodName "@streq store" "t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "contains /invoker/readonly" "id:5002621,chain,phase:2,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'JBoss',t:none,t:lowercase,msg:'VT-2018-02871-Deserialization command execution vulnerability in JBossAS 5.x/6.x (CVE-2017-12149)'"
SecRule REQUEST_BODY "@rx (org\.apache\.commons.collections\.functors\.chainedtransformer|org\.apache\.commons\.collections\.map\.lazymap|org\.apache\.commons\.collections\.functors\.invokertransformer)" "t:none,t:lowercase,setvar:tx.restrict_rule=1"
#########################################################################
# VT-2018-02870
# Absolute path traversal vulnerability in roundcube
# Deny parameter _alt.
SecRule ARGS:/^[\s\.\[_]task$/ "@contains addressbook" \
        "id:5002622,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        msg:'VT-2018-02870 - Roundcube Absolute path traversal vulnerability - (CVE-2015-8794)'"
SecRule ARGS:/^[\s\.\[_]action$/ "@contains photo" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        chain"
SecRule REQUEST_COOKIES_NAMES:_alt|REQUEST_COOKIES_NAMES:[alt|REQUEST_COOKIES_NAMES:.alt|REQUEST_COOKIES_NAMES:/\salt/|ARGS:/^[\s\.\[_]alt$/ "!@rx \.(jpg|png|gif)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "/desktopmodules/dnnarticle/getcss.ashx" \
	"id:5002623,chain,msg:'VT-2018-02869: File Inclusion in DNNArticle 7.7.x before 11.00.06 (CVE-2018-9126)',phase:1,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'DNNArticle',tag:'DotNetNuke'"
SecRule ARGS:CP "!@endsWith .css" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "/desktopmodules/dreamslider/downloadprovider.aspx" \
	"id:5002624,chain,msg:'VT-2018-02868: Module DreamSlider allow download file arbitrary',phase:2,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'DreamSlider 01.01.02',tag:'DotNetNuke'"
SecRule ARGS:File "!@endsWith .zip" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "/desktopmodules/dnnspot-store/modules/admin/uploadifyhandler.ashx" \
	"id:5002625,chain,msg:'VT-2018-02866: Function file Upload in DNNspotStore version 3.0.0-3.0.6 allow upload file with extension arbitrary',phase:2,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'DNNspotStore',tag:'DotNetNuke'"
SecRule FILES "!@rx  \.(png|jpg|jpeg|gif)$" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /cron.php" \
        "id:5002626,\
        msg:'VT-2018-02856 ebay Magento - Unrestricted Cron Script (Potential Code Execution / DoS)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule REQUEST_FILENAME "@rx [^a-z0-9\.\\\/_,-]" \
        "t:lowercase,t:none,t:trim,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /index.php/api/soap/index" \
        "id:5002627,\
        msg:'VT-2018-02855 ebay Magento - PHP FPM XML eXternal Entity Injection CVE-2015-5161',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule REQUEST_BODY  "@rx entity.*system.*" \
        "t:none,t:trim,t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /admin/cms_wysiwyg/directive/" \
	"id:5002628,\
	msg:'VT-2018-02854 Magento Shoplift exploit (SUPEE-5344) - SQL Injection (CVE-2015-1397)',\
	deny,\
	chain,\
	phase:2,\
	status:403,\
	log,\
	t:normalizePathWin,\
	t:none,t:lowercase,t:urlDecodeUni,\
	rev:1,severity:2,\
	tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS:filter "@rx [^a-z0-9_\.=&\[\]]" "t:none,t:lowercase,t:Base64Decode,\
setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains period" \
        "id:5002629,\
        msg:'VT-2018-02853 Magento CE <= 1.9.0.1 - (Authenticated) Remote Code Execution',\
        deny,\
        chain,\
        phase:2,\
        status:403,\
        log,\
        t:none,t:lowercase,\
        rev:1,severity:2,\
        tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule REQUEST_FILENAME "@contains tab_orders" \
        "chain,t:none,t:lowercase,t:trim"

SecRule REQUEST_FILENAME "@rx [a-f0-9]{32}" \
        "chain,t:none,t:lowercase,t:trim"

SecRule REQUEST_FILENAME "@contains ajaxblock" \
        "chain,t:none,t:lowercase,t:trim"

SecRule ARGS:ga "@rx ^o:.*:.*:.*{" "t:none,t:Base64Decode,t:lowercase,\
setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /magmi/web/magmi_import_run.php" \
	"id:5002630,\
	msg:'VT-2018-02852 Magento Server MAGMI Plugin - Cross-Site Scripting CVE-2015-2068',\
	phase:1,\
	deny,\
	status:403,\
	log,\
	chain,\
	t:none,\
	t:trim,t:lowercase,\
	t:normalizePathWin,\
	rev:1,severity:2,\
	tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS_NAMES "@rx [^a-z0-9_]" "t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"


SecRule REQUEST_FILENAME "@contains /magmi/web/magmi_import_run.php" \
        "id:5002631,\
        msg:'VT-2018-02852 Magento Server MAGMI Plugin - Cross-Site Scripting CVE-2015-2068',\
        phase:1,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:trim,t:lowercase,\
        t:normalizePathWin,\
        rev:1,severity:2,\
        tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS "@rx [^a-z0-9_]" "t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"


SecRule REQUEST_FILENAME "@contains /magmi/web/magmi.php" \
        "id:5002632,\
        msg:'VT-2018-02852 Magento Server MAGMI Plugin - Cross-Site Scripting CVE-2015-2068',\
        phase:1,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:trim,t:lowercase,\
        t:normalizePathWin,\
        rev:1,severity:2,\
        tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS:profile "@rx [^a-z0-9_]" "t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains /magmi/web/ajax_pluginconf.php" \
        "id:5002633,\
        msg:'VT-2018-02852 Magento Server MAGMI Plugin - File Inclusion CVE-2015-2067',\
        phase:1,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:trim,t:lowercase,\
        t:normalizePathWin,\
        rev:1,severity:2,\
        tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS:file "@contains .." "t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /magmi/web/plugin_upload.php" \
	"id:5002634,\
	msg:'VT-2018-02851 Magento Server MAGMI Plugin 0.7.19a - Unsafe File Upload (CVE-2014-8770)',\
	phase:1,\
	deny,\
	status:403,\
	log,\
	t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento',\
	setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /index.php/api/xmlrpc" \
        "id:5002635,\
        msg:'VT-2018-02850 Magento eCommerce - Local File Disclosure (XXE)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule REQUEST_BODY  "@rx entity.*system.*" \
        "t:none,t:trim,t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /set_general_setup" \
	"id:5002636,chain,msg:'VT-2018-02817 Seagate Business NAS Unauthenticated Remote Command Execution CVE-2014-8684',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'CodeIgniter'"
SecRule ARGS_POST:/^general[\s\.\[_]setup$/ "@rx description=(.*?);" \
	"t:none,t:trim,t:lowercase,t:urlDecode,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx \x00(.*?)([;\"}{]|//)" \
	"id:5002637,msg:'VT-2018-02816 Total Shop UK eCommerce CodeIgniter - Multiple Cross-Site Scripting Vulnerabilities CVE-2012-4236',phase:2,deny,status:403,log,t:none,t:trim,t:normalizePath,t:urlDecode,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'CodeIgniter',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (/wls-wsat/coordinatorporttype|/wls-wsat/coordinatorporttype11|/wls-wsat/coordinatorporttype12|/wls-wsat/participantportype|/wls-wsat/participantportype11|/wls-wsat/registrationporttyperpc|/wls-wsat/registrationporttyperpc11|/wls-wsat/registrationrequesterportype|/wls-wsat/registrationrequesterporttype11)" "id:5002638,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WebLogic',t:normalizePathWin,t:lowercase,rev:1,severity:2,msg:'VT-2018-02812-Oracle WebLogic - wls-wsat Component Deserialization Remote Code Execution (CVE-2017-10271)',setvar:tx.restrict_rule=1"
SecRule REQUEST_METHOD "@rx ^(?i)PATCH$" \
	"id:5002639,chain,msg:'VT-2018-02776, RCE in PATCH request in Spring Data REST (CVE-2017-8046)',phase:2,rev:1,t:none,log,deny,status:403,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Spring'"
SecRule REQUEST_HEADERS:Content-Type "@rx application\/json\-patch\+json" \
	"chain,t:none"
SecRule ARGS:path "@rx [\(\)]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /oauth/authorize" \
	"id:5002640,chain,msg:'VT-2018-02775, RCE in spring security oath, CVE-2016-4977',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Spring'"
SecRule ARGS:response_type|ARGS:redirect_uri "@rx \${.+}" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_BODY|REQUEST_FILENAME "@rx <!\s*entity(.*?)system(\s+)(\'|\")" \
	"id:5002641,msg:'VT-2018-02771 Symfony2 - Local File Disclosure',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePath,t:urlDecode,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Symfony',setvar:tx.restrict_rule=1"
SecRule ARGS "@rx \".+?\\\".+?-be.+?\"@.+?\..+|\".+?\\\'.+?-be.+?\"@.+?\..+" "id:5002642,msg:'VT-2018-02769 PHPMailer < 5.2.20, Zend < 2.4.11, SwiftMailer <= 5.4.5 (Exim MTA) - RCE, CVE-2016-10033, CVE-2016-10045',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PHPMailer, ZendMail, SwiftMailer',setvar:tx.restrict_rule=1"
SecRule ARGS "@rx (?i:(\".*?\\\'.+?\"\s*?@)|(\".*?\\\\\".+?\"\s*?@))" "id:5002643,msg:'VT-2018-02768 PHPMailer < 5.2.20, Zend < 2.4.11, SwiftMailer <= 5.4.5 (SendMail MTA) - Sendmail Argument Injection CVE-2016-10033, CVE-2016-10034, CVE-2016-10045, CVE-2016-10074',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PHPMailer, ZendMail, SwiftMailer',setvar:tx.restrict_rule=1"
SecRule REQUEST_METHOD "@rx ^(?i:PUT)$" "id:5002645,chain,phase:2,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Tomcat',rev:2,t:none,t:urlDecodeUni,severity:2,msg:'VT-2018-02559-Apache Tomcat Remote Code Execution via JSP upload (CVE-2017-12617)'"
SecRule REQUEST_FILENAME "@rx (?i:\.(php.?|asp|aspx|asa|asax|ascx|ashx|asmx|soap|cs|inc|jsp|jspf|jspx|java|html|htmlx|phtml|shtml|cfg|cfm|htaccess|cgi|dll|exe|bat|sh|py|pl|cer|war)(\.| |\/|\\\\|\:\:\$DATA))" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Content-Type "@rx .{4000}" "id:5002646,phase:2,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Tomcat',t:none,t:lowercase,msg:'VT-2018-02555-Apache Commons FileUpload and Apache Tomcat - Denial of Service (CVE-2014-0050)',setvar:tx.restrict_rule=1"
#########################################################################
# VT-2018-02495
# Roundcube 1.0.0 -> 1.2.2 - Remote Code Execution
# Deny option -OQueueDirectory and option -X (santize _from by filter [\s])
SecRule ARGS:/^[\s\.\[_]task$/ "@eq mail" \
        "id:5002647,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        msg:'VT-2018-02495 Roundcube 1.0.0 -> 1.2.2 - Remote Code Execution (CVE-2016-9920)'"
SecRule ARGS:/^[\s\.\[_]action$/ "@eq send" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        chain"
SecRule ARGS:/^[\s\.\[_]from$/ "[\s]" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:removeNulls,\
        setvar:tx.restrict_rule=1"
#########################################################################
# VT-2018-02494
# Roundcube Webmail 1.1.3 - Directory Traversal
# Deny use relative path
SecRule ARGS:/^[\s\.\[_]task$/ "@contains settings" \
        "id:5002648,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        msg:'VT-2018-02494 - Roundcube Webmail 1.1.3 - Directory Traversal (CVE-2015-8770)'"
SecRule ARGS:/^[\s\.\[_]action$/ "@contains save-prefs" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        chain"
SecRule ARGS:/^[\s\.\[_]skin$/ "@contains .." \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
#########################################################################
# VT-2018-02493
# RCE in Roundcube webmail before 0.8.7 and 0.9.x before 0.9.5
# Whitelist _session follow version 0.9.5.
SecRule ARGS:/^[\s\.\[_]action$/ "@contains save-pref" \
        "id:5002649,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        msg:'VT-2018-02493 - RCE in Roundcube webmail before 0.8.7 and 0.9.x before 0.9.5 (CVE-2013-6172)'"

SecRule ARGS:/^[\s\.\[_]session$/ "!@streq list_attrib/columns" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule ARGS:target "@rx \\\\|\/" \
	"id:5002650,msg:'VT-2018-02466 PhpMyAdmin - File Inclusion (CVE-2018-12613)',phase:2,deny,status:403,log,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin',setvar:tx.restrict_rule=1"
SecRule ARGS:find "@validateByteRange 1-255" \
	"id:5002651,chain,msg:'VT-2018-02464 PhpMyAdmin - Remote Code Execution (RCE) (CVE-2016-5734)',phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains tbl_find_replace.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS:/^pma[\s\.\[_]password$/ "@rx .{255,}" \
	"id:5002652,msg:'VT-2018-02463 - DoS vulnerability with long passwords (CVE-2014-9218)',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin',setvar:tx.restrict_rule=1"
SecRule ARGS:visualizationSettings[width]|ARGS:visualizationSettings[height] "@rx [^0-9]+" \
	"id:5002653,chain,msg:'VT-2018-02460 - PhpMyAdmin - Cross-site scripting (CVE-2013-1937)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains tbl_gis_visualization.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule FILES_TMP_CONTENT "@rx <!\s*entity\s+.+\s+system.+>" \
	"id:5002654,chain,msg:'VT-2018-02458 - PhpMyAdmin - Local File Inclusion via XXE injection (CVE-2011-4107)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains import.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES|REQUEST_COOKIES_NAMES "@rx (?:^#)|(?:\[#)" \
	"id:5002655,\
	msg:'VT-2018-02424 - A remote code execution vulnerability exists within multiple subsystems of Drupal 7.x and 8.x (CVE-2018-7602)',\
	phase:2,\
	t:none,\
	t:urlDecodeUni,\
	deny,\
	severity:2,\
	log,\
	status:403,\
	rev:2,\
	tag:'VTWAF',\
	tag:'VTWAF_MONITOR_VUL',\
	tag:'Drupal',\
	setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02423
# Drupal avatar_uploader v7.x-1.0-beta8 - Arbitrary File Disclosure
# Deny uri /sites/all/modules/avatar_uploader/lib/demo/view.php?file=

SecRule REQUEST_FILENAME "@contains avatar_uploader/lib/demo/view.php" \
	"deny,\
	id:5002656,\
	rev:1,\
	severity:2,\
	log,\
	tag:'VTWAF',\
	tag:'VTWAF_MONITOR_VUL',\
	tag:'Drupal',\
	t:none,\
	t:normalizePathWin,\
	t:urlDecodeUni,\
	msg:'VT-2018-02423 - Drupal avatar_uploader v7.x-1.0-beta8 - Arbitrary File Disclosure - CVE-2018-9205',\
	setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES|REQUEST_COOKIES_NAMES "@rx (?:^#)|(?:\[#)" \
	"id:5002657,\
	msg:'VT-2018-02422 - A remote code execution vulnerability exists within multiple subsystems of Drupal 7.x and 8.x (CVE-2018-7600)',\
	phase:2,\
	t:none,\
	t:urlDecodeUni,\
	deny,\
	severity:2,\
	log,\
	status:403,\
	rev:2,\
	tag:'VTWAF',\
	tag:'VTWAF_MONITOR_VUL',\
	tag:'Drupal',\
	setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02421
# Drupal 7.x Services Module Remote Code Execution
# Deny sql injection in request accept seriailization object

SecRule REQUEST_HEADERS:Content-Type "@contains application/vnd.php.serialized" \
    "phase:1,\
    id:5002658,\
    nolog,\
    pass,\
    ctl:requestBodyProcessor=URLENCODED"
SecRule REQUEST_HEADERS:Content-Type "@contains application/vnd.php.serialized" \
    "deny,\
    id:5002659,\
    chain,\
    phase:2,\
    rev:1,\
    status:403,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,\
    t:lowercase,\
    msg:'VT-2018-02421 - Drupal 7.x Services Module Remote Code Execution'"
SecRule REQUEST_BODY "\(|\)" \
    "t:none,\
    t:lowercase,\
    t:removeNulls,\
    setvar:tx.restrict_rule=1"
#########################################################################
# VT-2018-02420 
# Drupal Module CODER 2.5 - Remote Command Execution
# Deny URL: /modules/coder/coder_upgrade/scripts/coder_upgrade.run.php?file=
SecRule REQUEST_FILENAME "@contains /coder/coder_upgrade/scripts/coder_upgrade.run.php" \
    "deny,\
    id:5002660,\
    phase:1,\
    rev:1,\
    status:403,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,\
    t:lowercase,\
    t:urlDecode,\
    t:normalizePathWin,\
    msg:'VT-2018-02420 - Drupal Module CODER 2.5 - Remote Command Execution',\
    setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02418
# Drupal RESTWS Module 7.x Remote PHP Code Execution
# Deny pattern: q=taxonomy_vocabulary/id/function_name/parameters
SecRule ARGS:q "@contains taxonomy_vocabulary" \
    "deny,\
    chain,\
    status:403,\
    phase:1,\
    id:5002661,\
    rev:1,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,\
    t:lowercase,\
    t:trim,\
    t:urlDecodeUni,\
    t:removeNulls,\
    msg:'VT-2018-02418 - Drupal RESTWS Module 7.x Remote PHP Code Execution'"

SecRule ARGS:q "!@rx ^(taxonomy_vocabulary|taxonomy_vocabulary\/\w+\/(not_found)?\/\w+)$" \
    "t:none,\
    t:lowercase,\
    t:trim,\
    t:urlDecodeUni,\
    t:removeNulls,\
    setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02417
# Drupal < 7.34 - Denial of Service
SecRule ARGS:q "@streq user" \
	"id:5002662,\
	chain,\
	phase:2,\
	deny,\
	status:403,\
	log,\
	t:none,\
	t:urlDecodeUni,\
	t:trim,\
	t:lowercase,\
	rev:1,\
	severity:2,\
	tag:'VTWAF',\
	tag:'VTWAF_MONITOR_VUL',\
	tag:'Drupal',\
	msg:'VT-2018-02417 Drupal < 7.34 - Denial of Service (CVE-2014-9016)'"
SecRule ARGS:pass "@ge 500" \
	"t:none,\
	t:trim,\
	t:length,\
	setvar:tx.restrict_rule=1"
SecRule ARGS:option "@streq com_fields" "id:5002663,chain,msg:'VT-2018-02379 SQL injection vulnerability in Joomla! 3.7.x before 3.7.1 (CVE-2017-8917)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq fields" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:layout "@streq modal" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[fullordering] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains component/fields" "id:5002664,chain,msg:'VT-2018-02379 SQL injection vulnerability in Joomla! 3.7.x before 3.7.1 (CVE-2017-8917)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq fields" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:layout "@streq modal" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[fullordering] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule ARGS:option "@streq com_fields" "id:5002665,chain,msg:'VT-2018-02279 SQL injection vulnerability in Joomla! 3.7.0 before 3.7.1 CVE-2017-8917',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq fields" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:layout "@streq modal" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[fullordering] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains component/fields" "id:5002666,chain,msg:'VT-2018-02279 SQL injection vulnerability in Joomla! 3.7.0 before 3.7.1 (CVE-2017-8917)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq fields" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:layout "@streq modal" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[fullordering] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /component/users" \
	"id:5002667,chain,msg:'VT-2018-02177 Joomla! <= 3.6.4 Admin TakeOver CVE-2016-9838',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq registration.register" "chain, t:none,t:lowercase"
SecRule ARGS:jform[id]|ARGS:jform[groups] "@rx .*" "setvar:tx.restrict_rule=1"

SecRule ARGS:option "@streq com_users" \
	"id:5002668,chain,msg:'VT-2018-02177 Joomla! <= 3.6.4 Admin TakeOver CVE-2016-9838',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq registration.register" "chain, t:none,t:lowercase"
SecRule ARGS:jform[id]|ARGS:jform[groups] "@rx .*" "setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /component/users/" "id:5002669,chain,msg:'VT-2018-02172 Joomla Account Creation and Privilege Escalation CVE-2016-8869',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq user.register" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule ARGS:option "@streq com_users" "id:5002670,chain,msg:'VT-2018-02172 Joomla Account Creation and Privilege Escalation CVE-2016-8869',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq user.register" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains component/contenthistory"\
	"id:5002671,chain,msg:'VT-2018-02156 SQL injection vulnerability in Joomla! 3.2.x < 3.4.4 CVE-2015-7297',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq history" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[select] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule ARGS:option "@streq com_contenthistory" "id:5002672,chain,msg:'VT-2018-02156 SQL injection vulnerability in Joomla! 3.2.x < 3.4.4 CVE-2015-7297',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq history" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:list[select] "@rx [^\w\ \.]" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /administrator/components/com_simplephotogallery/lib/uploadFile.php" \
	"id:5002673,chain,msg:'VT-2018-02140 Joomla Simple Photo Gallery - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /components/com_creativecontactform/fileupload/" \
	"id:5002674,chain,msg:'VT-2018-02136 WordPress Plugin 0.9.7 / Joomla! Component 2.0.0 Creative Contact Form - Arbitrary File Upload CVE-2014-8739',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains weblinks-categories"  \
	"id:5002675,chain,msg:'VT-2018-02123 Joomla! <= 3.2.2 - SQL Injection',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:id "[^0-9]" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains com_media" \
	"id:5002676,chain,msg:'VT-2018-02112 Joomla! Component Media Manager - Arbitrary File Upload CVE-2013-5576',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"


SecRule ARGS:option "@streq com_media" \
	"id:5002677,chain,msg:'VT-2018-02112 Joomla! Component Media Manager - Arbitrary File Upload CVE-2013-5576',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /administrator/components/com_civicrm/civicrm/packages/openflashchart/php-ofc-library/ofc_upload_image.php" \
	"id:5002678,chain,msg:'VT-2018-02054 Joomla Civicrm Extension - Arbitrary File Upload CVE-2012-1116',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:name "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains component/collector" \
	"id:5002679,chain,msg:'VT-2018-02102 Joomla Collector Extension - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq filemanager.upload" "chain,t:none,t:lowercase,t:trim"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule ARGS:option "@streq com_collector" \
	"id:5002680,chain,msg:'VT-2018-02102 Joomla Collector Extension - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:task "@streq filemanager.upload" "chain,t:none,t:lowercase,t:trim"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /components/com_hwdvideoshare/assets/uploads/flash/flash_upload.php" \
"id:5002681,chain,msg:'VT-2018-02073 Joomla! Component hwdVideoShare - flash_upload.php Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule ARGS_GET:jqUploader "@streq 1" "chain,t:none,t:trim"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-with-spritz/wp.spritz.content.filter.php"\
		"id:5002682,\
		msg:'VT-2018-01044 - WordPress Plugin WP with Spritz 1.0 - LFI',\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
        t:none,\
        t:lowercase,\
        t:normalizePathWin,\
        t:urlDecodeUni"

SecRule ARGS:url "!@rx ^http"\
		"t:none,\
		t:lowercase,\
		t:urlDecode,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /plugins/wp-google-drive/gdrive-ajaxs.php"\
        "chain,\
        phase:2,\
        id:5002683,\
        msg:'VT-2018-01038 - Wordpress plugin Unlink RCE wp-google-drive2.2',\
        deny,status:403,log,rev:1,severity:2,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Wordpress',\
        t:none,\
        t:lowercase,\
        t:normalizePathWin,\
        t:urlDecodeUni"

SecRule ARGS:ajaxstype "@streq del_fl_bkp"\
        "chain,\
        t:none,\
        t:trim,\
        t:lowercase"

SecRule ARGS:file_name "@contains .."\
        "t:none,\
        t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /simple-fields/simple_fields.php"\
		"id:5002684,\
		msg:'VT-2018-01037 - WordPress Plugin Simple Fields 0.2 - 0.3.5 - LFI',\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:normalizePathWin,\
		t:urlDecodeUni,\
		t:trim,\
        t:lowercase"

SecRule ARGS:wp_abspath "@validateByteRange 1-255"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php"\
		"id:5002685,\
		msg:'VT-2018-00932 - Wordpress Plugin Site Editor 1.1.1 - LFI - CVE-2018-7422',\
		deny,chain,status:403,log,rev:1,severity:2,\
        severity:2\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
        t:lowercase,\
        t:normalizePathWin,\
        t:urlDecodeUni"

SecRule ARGS:ajax_path "!@contains shortcodes.patterns.php"\
		"t:none,\
		t:trim,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/load-scripts.php"\
        "chain,\
        id:5002686,\
        deny,status:403,log,rev:1,severity:2,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Wordpress',\
        t:none,\
        t:lowercase,\
        t:normalizePathWin,\
        t:urlDecodeUni,\
        msg:'VT-2018-01030 - WordPress Core - load-scripts.php Denial of Service (CVE-2018-6389)'"

SecRule ARGS:load[] "@ge 200"\
        "t:none,\
        t:trim,\
        t:length,\
        setvar:tx.restrict_rule=1"
SecRule MULTIPART_FILENAME "@rx \.(phtml|shtml|html|php.?|htaccess)\."\
		"id:5002687,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
        t:lowercase,\
        t:trim,\
		msg:'VT-2018-01022 - WordPress Plugin LearnDash 2.5.3 - Arbitrary File Upload'"
SecRule FILES_NAMES "@contains uploadfiles[]"\
		"chain,\
		t:none,\
		t:lowercase"
SecRule ARGS_NAMES "post"\
		"t:none,\
        t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-json/wp/v2/users" \
	"id:5002688,chain,msg:'VT-2018-00978 Sensitive Information Disclosure Vulnerability in WordPress 4.7 (CVE-2017-5487)',phase:2,deny,status:403,log,t:none,t:normalizePathWin,t:lowercase,rev:2,severity:2,tag:'VTWAF',tag:'WordPress'"
SecRule &REQUEST_COOKIES_NAMES:/^wordpress_([0-9a-fA-f]{32})$/ "!@ge 1" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp/v2/posts"\
		"id:5002689,\
		chain,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:urlDecodeUni,\
		t:normalizePathWin,\
		t:lowercase,\
		deny,status:403,log,rev:1,severity:2,\
		msg:'VT-2018-00968 - Content injection vulnerability in WordPress 4.7.x before 4.7.2 (CVE-2017-1001000)'"
SecRule ARGS:id "@rx \D"\
		"t:none,\
        setvar:tx.restrict_rule=1"
SecRule ARGS:wpv-image "!@rx \.(png|bmp|jpg|gif|bgp)$"\
		"id:5002690,\
		msg:'VT-2018-00956 - WordPress Plugin WP Vault 0.8.6.6 - Local File Inclusion',\
		deny,status:403,log,rev:1,severity:2,\
		phase:2,\
		rev:1,\
        severity:2\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:trim\
        t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx campaign[/\\\\]+count_of_send\.php|lists[/\\\\]+csvexport\.php"\
		"id:5002691,\
		msg:'VT-2018-00944 - WordPress Plugin WP with Spritz 1.0 - LFI',\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:trim,\
        t:lowercase"

SecRule ARGS:pl "!@rx [/\\\\]+wp-load\.php$"\
		"t:none,\
		t:lowercase,\
		t:urlDecode,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php"\
		"id:5002692,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00943 - WordPress 4.5.3 - Directory Traversal / Denial of Service (CVE-2016-6896,CVE-2016-6897)'"
SecRule ARGS:action "@streq update-plugin"\
		"chain,t:none,\
		t:lowercase,\
		t:trim"
SecRule ARGS:plugin "@rx dev[\\\/]+random"\
		"t:none,\
		t:lowercase,\
		t:urlDecodeUni,\
		setvar:tx.restrict_rule=1"
SecRule ARGS:/^gf[\s\.\[_]page$/ "@streq upload" \
	"id:5002693,chain,msg:'VT-2018-00927 WordPress Plugin Gravity Forms 1.8.19 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:/^form[\s\.\[_]id$/ "@rx .+" \
	"chain,t:none"
SecRule ARGS:/^field[\s\.\[_]id$/ "@rx .+" \
	"chain,t:none"
SecRule ARGS:name "@rx \.(php.?|htaccess|html|phtml|shtml)" \
	"t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/wp-mobile-detector/resize.php" \
	"id:5002694,chain,msg:'VT-2018-00920 WordPress Plugin WP Mobile Detector 3.5 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:src "!@rx \.(png|gif|jpg|jpeg|jif|jfif|svg)$" \
	"t:none,t:urlDecodeUni,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx /wp-content/plugins/acf-frontend-display/js/(.*?)\.php" \
	"id:5002695,chain,msg:'VT-2018-00833 WordPress Plugin ACF Frontend Display 2.0.5 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx /wp-content/plugins/aviary-image-editor-add-on-for-gravity-forms/(.*?)\.php" \
	"id:5002696,chain,msg:'VT-2018-00829 WordPress Plugin Aviary Image Editor Addon For Gravity Forms 3.0 Beta - Arbitrary File Upload CVE-2015-4455',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|shtml|php3|php4|php5|php7|phps|htaccess)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/themes/mtheme-unus/css/css.php" \
	"id:5002697,chain,msg:'VT-2018-00823 WordPress Plugin WP Mobile Edition - Local File Inclusion',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:files "@rx ((.*\.(?!(js|css)$))|:)" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/wordpress-member-private-conversation/doupload.php" \
	"id:5002698,chain,msg:'VT-2018-00821 WordPress Plugin Nmedia WordPress Member Conversation 1.35.0 CVE-2012-3577',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|shtml|php3|php4|php5|php7|phps|htaccess)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/really-simple-guest-post/simple-guest-post-submit.php" \
	"id:5002699,chain,msg:'VT-2018-00820 WordPress Plugin Really Simple Guest Post 1.0.6 - Local File Inclusion ',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST_NAMES "@streq rootpath" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"id:5002700,chain,msg:'VT-2018-00819 WordPress Plugin zM Ajax Login & Register 1.0.9 - Local File Inclusion CVE-2015-4153',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:template "@rx [^a-zA-Z0-9-]" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/dzs-zoomsounds/admin/upload.php" \
	"id:5002701,chain,msg:'VT-2018-00817 WordPress Plugin dzs-zoomsounds 2.0 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/mailchimp-subscribe-sm/data.php" \
	"id:5002702,chain,msg:'VT-2018-00813 WordPress Plugin MailChimp Subscribe Forms 1.1 - Remote Code Execution',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS "@contains <?" \
	"t:none,t:trim,t:urlDecode,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/website-contact-form-with-file-upload/lib/wide-image/image-processor.php" \
	"id:5002703,chain,msg:'VT-2018-00799 WordPress Plugin N-Media Website Contact Form with File Upload 1.5 - Local File Inclusion',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:demo "@contains .." \
	"t:none,t:trim,t:lowercase,t:normalizePathWin,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-comments-post.php" \
	"id:5002704,chain,msg:'VT-2018-00794 WordPress 4.2 - Persistent Cross-Site Scripting CVE-2015-3440',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:comment "@gt 10240" \
	"t:none,t:trim,t:lowercase,t:length,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx /wp-content/plugins/work-the-flow-file-upload/public/assets/jquery-file-upload(.*?)/server/php/index.php" \
	"id:5002705,chain,msg:'VT-2018-00791 WordPress Plugin Work The Flow - Arbitrary File Upload (Metasploit)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/sexy-contact-form/includes/fileupload/index.php" \
	"id:5002706,chain,msg:'VT-2018-00790 WordPress Plugin Creative Contact Form - Arbitrary File Upload (Metasploit) CVE-2014-8739',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/reflex-gallery/admin/scripts/fileuploader/php.php" \
	"id:5002707,chain,msg:'VT-2018-00789 WordPress Plugin Reflex Gallery - Arbitrary File Upload (Metasploit) CVE-2015-4133',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:(\/Telerik\.Web\.UI\.WebResource\.axd))" \
	"id:5002708,chain,msg:'VT-2018-02820-A weakness in Telerik.Web.UI.dll allows remote attackers to perform arbitrary file uploads or execute arbitrary code (CVE-2017-11357)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Telerik'"
SecRule ARGS:type "@contains rau" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (?i:((\/Telerik\.Web\.UI\.DialogHandler\.as(p|h)x)|(\/DesktopModules\/Admin\/RadEditorProvider\/DialogHandler\.as(p|h)x)))" \
	"id:5002709,msg:'VT-2018-02819-A cryptographic weakness in Telerik.Web.UI.dll (CVE-2017-11317)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:4,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Telerik',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME: "@endsWith axmlrpc.php" "id:5002710,chain,phase:1,pass,setvar:'TX.openx_axmlrpc=1',nolog,t:none,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Openx',msg:'Set request body processor to be XML'"
SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "t:none,t:normalizePath,t:lowercase,ctl:requestBodyProcessor=XML"

SecRule TX:openx_axmlrpc "@eq 1" "id:5002711,chain,phase:2,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Openx',t:none,t:lowercase,rev:1,severity:2,msg:'VT-2018-02484-OpenX Source 2.8.11 and earlier, allows remote attackers to execute arbitrary SQL commands (CVE-2013-7149)'"
SecRule XML:/methodCall/params/param/value/string/text() "@rx [^\w\ \.]" "t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02416
# Drupal HTTP Parameter Key/Value SQL Injection
# Deny sql syntax
SecRule ARGS:q "node" \
    "id:5002712,\
    chain,\
    deny,\
    phase:2,\
    rev:1,\
    status:403,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,\
    t:lowercase,\
    t:trim,\
    msg:'VT-2018-02416 - Drupal HTTP Parameter Key/Value SQL Injection - CVE-2014-3704'"
SecRule ARGS:destination "node" \
    "chain,\
    t:none,\
    t:lowercase,\
    t:trim"
SecRule ARGS_NAMES|REQUEST_COOKIES_NAMES "[^a-z0-9_\-\[\]\.]" \
    "t:none,\
    t:lowercase,\
    t:trim,\
    t:urlDecode,\
    t:urlDecodeUni,\
    setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02415
# Persistent XSS in wysiwyg CKEditor <4.1 Drupal 6.x & 7.x
# Deny xss syntax
# VT-2018-02415 Sử dụng luật chặn XSS của CRS
SecRule ARGS:/^comment[\s\.\[_]body\[und\]\[0\]\[value\]$/ "<.*>|javascript:" \
	"id:5002713,\
	deny,\
	phase:2,\
    rev:1,\
    status:403,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,t:urlDecode,t:lowercase\
    msg:'VT-2018-02415 - Persistent XSS in wysiwyg CKEditor <4.1 Drupal 6.x & 7.x',\
    setvar:tx.restrict_rule=1"
###################################################################
# VT-2018-02395
# Drupal OpenID External Entity Injection
# Set whitelist URL for openid [localhost,127.0.0.1]
SecRule ARGS:q "@streq node" \
	"id:5002714,\
	deny,\
    chain,\
	phase:2,\
    rev:1,\
    status:403,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Drupal',\
    t:none,t:urlDecode,t:lowercase,\
    msg:'VT-2018-02395 - Drupal OpenID External Entity Injection - CVE-2012-4554'"
SecRule ARGS:destination "@streq node" \
    "chain,\
    t:none,t:urlDecode,t:lowercase"
SecRule ARGS:/^openid[\s\.\[_]identifier$/ "!@rx (^https?:\/\/)?(localhost\.com|127.0.0.1)$" \
    "t:none,t:urlDecode,t:lowercase,\
    setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /administrator/components/com_joomlaupdate/restore.php" \
	"id:5002715,chain,msg:'VT-2018-02135 Joomla! Component Akeeba Kickstart - Unserialize Remote Code Execution (CVE-2014-7228)',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:factory "@rx O:\+?[0-9]+" "t:none,t:base64Decode,setvar:tx.restrict_rule=1"
SecRule ARGS_POST "@contains #_memberAccess" \
	"id:5002716,chain,msg:'VT-2018-02848 RCE Strut 2.3.x with Struts1-plugin <=2.3.33 (CVE-2017-9791)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule ARGS_POST "@contains @java." \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule ARGS "@contains #_memberAccess" \
	"id:5002717,msg:'VT-2018-02847 RCE Strut 2.3.x with Struts 2.0.1 - Struts 2.3.33, Struts 2.5 - Struts 2.5.10 CVE-2017-12611',phase:2,chain,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule ARGS "@contains @java." \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule ARGS_POST:/^person/ "@rx [^a-zA-Z0-9-_ ]+" \
	"id:5002718,chain,msg:'VT-2018-02831 XSS on Struts2 2.0.14 and 2.2.3  CVE-2012-1006 ',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts2'"
SecRule REQUEST_FILENAME "@contains /person/editPerson.action" \
	"t:none,t:urlDecodeUni,t:normalizePathWin,setvar:tx.restrict_rule=1"

SecRule ARGS_POST:clientName "@rx [^a-zA-Z0-9_.]+" \
	"id:5002719,chain,msg:'VT-2018-02831 XSS on Struts2 2.0.14 and 2.2.3  CVE-2012-1006',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts2'"
SecRule REQUEST_FILENAME "@endsWith /orders" \
	"t:none,t:urlDecodeUni,t:normalizePathWin,setvar:tx.restrict_rule=1"

SecRule ARGS_POST:theText "@rx [^a-zA-Z0-9-_., ]+" \
"id:5002720,chain,msg:'VT-2018-02831 XSS on Struts2 2.0.14 and 2.2.3  CVE-2012-1006 ',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts2'"
SecRule REQUEST_FILENAME "@endsWith /upload/upload-submit.do" \
	"chain,t:none,t:urlDecodeUni,t:normalizePathWin"
SecRule ARGS_GET:queryParam "@eq Successful" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule ARGS_POST:message "@rx [^a-zA-Z0-9-_. ]+" \
	"id:5002721,chain,msg:'VT-2018-02831 XSS on Apache Struts 1.3.10 CVE-2012-2007',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts1'"
SecRule REQUEST_FILENAME "@endsWith /processSimple.do" \
	"t:none,t:urlDecodeUni,t:normalizePathWin,setvar:tx.restrict_rule=1"

SecRule ARGS_POST:message "@rx [^a-zA-Z0-9-_. ]+" \
"id:5002722,chain,msg:'VT-2018-02831 XSS on Apache Struts 1.3.10 CVE-2012-2007',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts1'"
SecRule REQUEST_FILENAME "@endsWith /processDyna.do" \
	"t:none,t:urlDecodeUni,t:normalizePathWin,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "^\/c\/portal\/json_service$" \
	"id:5002723,chain,msg:'VT-2018-02786, Liferay Portal 6.0.x < 6.1 - Privilege Escalation',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay',tag:'Liferay Portal'"
SecRule ARGS:serviceClassName "^com\.liferay\.portal\.service\.userserviceutil$" \
	"chain,t:none,t:trim,t:urlDecodeUni,t:lowercase"
SecRule ARGS:serviceMethodName "^updateorganizations$" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:serviceParameters "@rx ^\['userid'.*'organizationids'\]$" \
	"t:none,t:trim,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_METHOD "^PROPPATCH$" \
	"id:5002724,chain,msg:'Set request body processor to be URLENCODED',phase:1,pass,nolog,t:none,t:trim,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay'"
SecRule REQUEST_URI "@contains /tunnel-web/secure/webdav" \
	"t:none,t:trim,t:lowercase,t:urlDecode,t:normalizePathWin,ctl:requestBodyProcessor=URLENCODED"

SecRule REQUEST_METHOD "^PROPPATCH$" \
	"id:5002725,chain,msg:'VT-2018-02785,Liferay 6.0.x - WebDAV File Reading,2012',phase:2,deny,status:403,log,t:none,t:trim,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay'"
SecRule REQUEST_URI "@contains /tunnel-web/secure/webdav" \
	"chain,t:none,t:trim,t:lowercase,t:urlDecode,t:normalizePathWin"
SecRule REQUEST_BODY "@rx <!\s*entity\s+.+\s+system.+>" \
	"t:none,t:trim,t:lowercase,t:htmlEntityDecode,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx .*java\s*\.\s*lang\s*\..*" \
	"id:5002726,msg:'VT-2018-02778, RCE in spring data commons, CVE-2018-1273',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Spring',tag:'Spring Data Commons',setvar:tx.restrict_rule=1"
SecRule XML:/map/entry/jdk.nashorn.internal.objects.NativeString/flags/text() "@rx .+?" \
	"id:5002727,msg:'VT-2018-02846 RCE - Apache Struts versions 2.1.2 - 2.3.33 and Struts 2.5 - Struts 2.5.12  CVE-2017-9805 Set request body processor to be XML',phase:2,deny,status:403,log,ctl:requestBodyProcessor=XML,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains xhr_send" \
	"id:5002728,chain,msg:'VT-2018-02777, Remote Code Execution with spring-messaging, CVE-2018-1270',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Spring'"
SecRule ARGS_POST:selector "@rx .*java\s*\.\s*lang\s*.*" \
	"chain,t:none,t:lowercase,t:urlDecodeUni"
SecRule ARGS_POST_NAMES "destination" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS:dl|ARGS:del "@rx \.\." \
	"id:5002729,chain,msg:'VT-2018-02461 Laravel - Local File Download, Delete (CVE-2018-8947)',phase:2,deny,status:403,log,t:trim,t:lowercase,t:urlDecodeUni,t:Base64Decode,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Laravel'"
SecRule REQUEST_FILENAME "@contains logs" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS:/^from[\s\.\[_]prefix$/ "@validateByteRange 1-255" \
	"id:5002730,chain,msg:'VT-2018-02461 PhpMyAdmin - Remote Code Execution (RCE) through preg_replace() (CVE-2013-3238)',phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains db_structure.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"

SecRule ARGS:/^filename[\s\.\[_]template$/ "@rx \.php|\.pht|\.phtml|\.php3|\.php4|\.php5|\.php7|\.phps|\.shtml|\.htaccess" \
	"id:5002731,chain,msg:'VT-2018-02461 PhpMyAdmin - Remote Code Execution (RCE) insecure names of locally saved dump files (CVE-2013-3239)',phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains export.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"

SecRule ARGS:what "@rx \.\." \
	"id:5002732,chain,msg:'VT-2018-02461 PhpMyAdmin - File Inclusion (CVE-2013-3240)',phase:2,deny,status:403,log,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains export.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS:c "@rx .*" \
	"id:5002733,chain,msg:'VT-2018-02459 PhpMyAdmin - Remote Code Execution (RCE) - backdoor (CVE-2012-5159)',phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PhpMyAdmin'"
SecRule REQUEST_FILENAME "@contains server_sync.php" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/photocart-link/decode.php" \
	"id:5002734,chain,msg:'VT-2018-00909 WordPress Plugin Photocart Link 1.6 - Local File Disclosure',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:id "!@rx (?i:\.(png|gif|jpg|jpeg|jif|jfif|svg))$" \
	"t:none,t:base64Decode,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/imdb-widget/pic.php" \
	"id:5002735,chain,msg:'VT-2018-00908 WordPress Plugin IMDb Profile Widget 1.0.8 - Local File Disclosure',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:url "!@rx ^(https?:\/\/)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/dharma-booking/frontend/ajax/gateways/proccess.php" \
	"id:5002736,chain,msg:'VT-2018-00906 WordPress Plugin Dharma Booking 2.38.3 - File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:gateway "@validateByteRange 1-255" \
	"t:none,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/dharma-booking/frontend/ajax/gateways/proccess.php" \
	"id:5002737,chain,msg:'VT-2018-00906 WordPress Plugin Dharma Booking 2.38.3 - File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:gateway "@rx ^(https?:\/\/)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/brandfolder/callback.php" \
	"id:5002738,chain,msg:'VT-2018-00905 WordPress Plugin Brandfolder 3.0 - Local/Remote File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:/^wp[\s\.\[_]abspath$/ "@validateByteRange 1-255" \
	"t:none,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/brandfolder/callback.php" \
	"id:5002752,chain,msg:'VT-2018-00905 WordPress Plugin Brandfolder 3.0 - Local/Remote File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:/^wp[\s\.\[_]abspath$/ "@rx ^(https?:\/\/)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/abtest/abtest_admin.php" \
	"id:5002739,chain,msg:'VT-2018-00902 WordPress Plugin Abtest - Local File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@validateByteRange 1-255" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/site-import/admin/page.php" \
	"id:5002740,chain,msg:'VT-2018-00899 WordPress Plugin Site Import 1.0.1 - Local File Disclosure',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:url "@contains .." \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/themes/beauty-premium/includes/sendemail.php" \
	"id:5002741,chain,msg:'VT-2018-00897 WordPress Theme Beauty & Clean 1.0.8 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php.?|htaccess|shtml|phtml|html)" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php" \
	"id:5002742,chain,msg:'VT-2018-00868 WordPress Plugin Gwolle Guestbook 1.5.3 - Remote File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:abspath "@validateByteRange 1-255" \
	"t:none,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php" \
	"id:5002743,chain,msg:'VT-2018-00906 WordPress Plugin Gwolle Guestbook 1.5.3 - Remote File Inclusion',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:abspath "@rx ^(https?:\/\/)" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"id:5002744,chain,msg:'VT-2018-00910 WordPress Plugin Advanced Video 1.0 - Local File Disclosure',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@streq ave_publishpost" \
	"chain,t:none,t:lowercase,t:trim"
SecRule ARGS:title "@rx .+" \
	"chain,t:none"
SecRule ARGS:short "@rx .+" \
	"chain,t:none"
SecRule ARGS:term "@rx .+" \
	"chain,t:none"
SecRule ARGS:thumb "!@rx \.(jpeg|jpg|png|gif)$" \
	"t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin.php" \
	"id:5002745,chain,msg:'VT-2018-00782 WordPress Plugin MiwoFTP 1.0.5 - Cross-Site Request Forgery / Arbitrary File Creation / Remote Code Execution',phase:2,deny,status:403,log,t:none,t:trim,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:page "@streq miwoftp" \
	"t:none,t:trim,t:lowercase,chain"
SecRule &REQUEST_HEADERS:Referer "@eq 0" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"id:5002746,chain,msg:'VT-2018-00778 WordPress Plugin N-Media Website Contact Form with File Upload 1.3.4 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:2,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@contains nm_webcontact_upload_file" \
	"t:none,t:trim,t:urlDecode,chain"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/videowhisper-video-conference-integration/vc/vw_upload.php" \
	"id:5002747,chain,msg:'VT-2018-00770 WordPress Plugin VideoWhisper Video Conference Integration 4.91.8 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(phtml|htaccess|shtml|rhtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/woopra/inc/php-ofc-library/ofc_upload_image.php" \
	"id:5002748,chain,msg:'VT-2018-00602 WordPress Plugin Woopra Analytics - ofc_upload_image.php Arbitrary PHP Code Execution',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:name "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml|rhtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-comments-post.php" \
	"id:5002749,chain,msg:'VT-2018-00562 WordPress Plugin W3 Total Cache - PHP Code Execution (Metasploit) CVE-2013-2010',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:comment "@rx <!--\s*(mclude|mfunc|dynamic-cached-content)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/simple-ads-manager/sam-ajax-admin.php"\
		"id:5002750,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00767 - WordPress Plugin Simple Ads Manager 2.5.94 - Arbitrary File Upload (CVE-2015-2825)'"

SecRule ARGS:action "@streq upload_ad_image"\
		"chain,t:none,\
		t:lowercase,\
		t:trim"

SecRule MULTIPART_FILENAME "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml|rhtml)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /admin/upload-file.php"\
		"id:5002751,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00764 - WordPress Theme Multiple WordPress UpThemes Themes - Arbitrary File Upload'"

SecRule ARGS_NAMES "upload[\s\.\[_]path"\
		"chain,t:none,\
		t:lowercase"

SecRule MULTIPART_FILENAME "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml|rhtml)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/rest(\/default)?\/v1\/(guest-carts|carts)\/(mine|[a-f0-9]{32})\/(set-payment-information|payment-information)" \
        "id:5002753,\
        msg:'VT-2018-02857 Magento unauthenticated arbitrary unserialize -> arbitrary write file (CVE-2016-4010)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"
        
SecRule ARGS:paymentMethod.additional_data.additional_information "@rx ^o:.*:.*:.*{" \
        "t:none,t:trim,t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /cli" "id:5002758,chain,phase:1,pass,setvar:'TX.jenkins_xml=1',nolog,ctl:requestBodyProcessor=URLENCODED,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,t:normalizePathWin,t:lowercase,msg:'Set request body processor to be URLENCODED'"
SecRule REQUEST_HEADERS:Content-Type "@within application/octet-stream" "t:none,t:lowercase,setvar:'TX.jenkins_xml=1',ctl:requestBodyProcessor=URLENCODED"

SecRule TX:jenkins_xml "@eq 1" "id:5002759,chain,phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,msg:'VT-2018-02888-Jenkins CLI HTTP Java Deserialization (CVE-2016-9299)'"
SecRule REQUEST_BODY "@rx (org\.apache\.commons\.collections\.map\.flat3map|com\.sun\.jndi\.ldap\.ldapattribute)" "t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@contains #_memberAccess" \
	"id:5002760,msg:'VT-2018-02845 RCE - Apache Struts version between 2.3.20 and 2.3.28 (except 2.3.20.2 and 2.3.24.2) (CVE-2016-3087)',phase:2,deny,status:403,log,t:urlDecode,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Content-Type "@contains #_memberAccess" \
	"id:5002761,msg:'VT-2018-02844 RCE - Apache Struts 2.3.5 < 2.3.31 / 2.5 < 2.5.10 (CVE-2017-5638)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@contains #_memberAccess" \
	"id:5002762,chain,msg:'VT-2018-02843 RCE - Apache Struts version between 2.3.20 and 2.3.28 (except 2.3.20.2 and 2.3.24.2) (CVE-2016-3081)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule ARGS_NAMES "@contains method:" \
	"t:none,t:lowercase,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule ARGS_GET_NAMES "^p_p_lifecycle$" \
	"id:5002763,chain,msg:'VT-2018-02790, Liferay CE < 6.2 CE GA6 - Persistent Cross-Site Scripting, CVE-2016-3670',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay',tag:'Liferay Portal'"
SecRule ARGS_GET:/(_[0-9]*_)struts_action/ "@rx .*\/(create_account|edit_user)" \
	"chain,t:none,t:trim,t:urlDecodeUni,t:lowercase"
SecRule ARGS_POST:/(_[0-9]*_)screenName/|ARGS_POST:/(_[0-9]*_)emailAddress/|ARGS_POST:/(_[0-9]*_)firstName/|ARGS_POST:/(_[0-9]*_)middleName/|ARGS_POST:/(_[0-9]*_)lastName/|ARGS_POST:/(_[0-9]*_)jobTitle/ "@rx <.*>" \
	"t:none,t:trim,t:lowercase,t:urlDecodeUni,t:htmlEntityDecode,setvar:tx.restrict_rule=1"
SecRule ARGS_GET_NAMES "^p_p_lifecycle$" \
	"id:5002764,chain,msg:'VT-2018-02789, Liferay Portal 5.1.2 - Persistent Cross-Site Scripting',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay',tag:'Liferay Portal'"
SecRule ARGS_GET:/(_[0-9]*_)struts_action/ "@rx .*\/(create_account|edit_user)" \
	"chain,t:none,t:trim,t:urlDecodeUni,t:lowercase"
SecRule ARGS_POST:/(_[0-9]*_)screenName/|ARGS_POST:/(_[0-9]*_)emailAddress/|ARGS_POST:/(_[0-9]*_)firstName/|ARGS_POST:/(_[0-9]*_)middleName/|ARGS_POST:/(_[0-9]*_)lastName/|ARGS_POST:/(_[0-9]*_)jobTitle/ "@rx <.*>" \
	"t:none,t:trim,t:lowercase,t:urlDecodeUni,t:htmlEntityDecode,setvar:tx.restrict_rule=1"
SecRule ARGS:uultra-form-cvs-form-conf  ".?" \
	"id:5002765,chain,msg:'VT-2018-00864 WordPress Plugin Users Ultra 1.5.50 - Unrestricted File Upload',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.csv$" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:uultra-activate-account "@rx (active|pending)" \
	"chain,t:none,t:lowercase,t:trim"
SecRule ARGS:uultra-send-welcome-email "@streq 1" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin.php" \
	"id:5002766,chain,msg:'VT-2018-00855 WordPress Plugin Responsive Thumbnail Slider 1.0 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "!@rx \.(png|gif|jpg|jpeg|jif|jfif|svg)$" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:page "@streq responsive_thumbnail_slider_image_management" \
	"chain,t:none,t:lowercase,t:trim"
SecRule ARGS:action "@streq addedit" \
	"chain,t:none,t:lowercase,t:trim"
SecRule ARGS:btnsave ".?" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/asset-manager/upload.php" \
	"id:5002767,chain,msg:'VT-2018-00395 WordPress Plugin Asset Manager 0.2 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php.?|htaccess|shtml|phtml|html)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/foxypress/uploadify/uploadify.php" \
	"id:5002768,chain,msg:'VT-2018-00394 WordPress Plugin Foxypress 0.4.1.1 < 0.4.2.1 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php.?|htaccess|shtml|phtml|html)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/wpmarketplace/uploadify/uploadify.php" \
	"id:5002769,chain,msg:'VT-2018-00391 WordPress Plugin Marketplace 1.5.0 < 1.6.1 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php.?|htaccess|shtml|phtml|html)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-content/plugins/wp-property/third-party/uploadify/uploadify.php" \
	"id:5002770,chain,msg:'VT-2018-00390 WordPress Plugin WP-Property 1.35.0 - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php.?|htaccess|shtml|phtml|html)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/sexy-contact-form/includes/fileupload/index.php" \
        "id:5002771,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:trim,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00710 - Wordpress - Creative Contact Form plugin- Arbitrary File Upload - (CVE-2014-7969)'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin.php" \
        "id:5002772,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00706 - WordPress Plugin Slideshow Gallery 1.4.6 - Arbitrary File Upload - (CVE-2014-5460)'"

SecRule ARGS:page "@contains slideshow-slides" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        chain"

SecRule MULTIPART_FILENAME "!@rx \.(jpg|png|gif|jpeg|jif|jfif|svg)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/force-download.php" \
        "id:5002773,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00689 - Wordpress - ShortCode Plugin - Local File Inclusion Vulnerability - (CVE-2014-5465)'"

SecRule ARGS:file "!@rx \.(jpg|png|jif|jfif|svg|pdf|mp4|mp3|gif|jpeg)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/wp-copysafe-pdf/lib/uploadify/uploadify.php" \
        "id:5002774,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00676 - Wordpress Plugin CopySafe PDF Protection - Arbitrary File Upload'"

SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /index.php/photocrati_ajax" \
        "id:5002775,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00658 - WordPress Plugin NextGEN Gallery 1.9.1 (2.0.63) - \'photocrati_ajax\' Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "!@rx \.(jpg|png|gif|jpeg|jif|jfif|svg)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
        "id:5002776,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00650 - WordPress Plugin Ajax Pagination 1.1 - Path Traversal - (CVE-2014-2674)'"

SecRule ARGS:action "@eq ajax_navigation" \
        "chain,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni"

SecRule ARGS:loop "@contains .." \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/invit0r/lib/php-ofc-library/ofc_upload_image.php" \
        "id:5002777,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00425 - WordPress Plugin Invit0r - \'ofc_upload_image.php\' Arbitrary File Upload'"
SecRule ARGS:name "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/contus-hd-flv-player/uploadvideo.php" \
        "id:5002778,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00424 - WordPress Plugin HD FLV Player - \'uploadVideo.php\' Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/contus-video-galleryversion-10/upload1.php" \
        "id:5002779,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        rev:1,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00422 - WordPress Plugin Contus Video Gallery - \'upload1.php\' Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/custom-content-type-manager/upload_form.php" \
        "id:5002780,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00421 - WordPress Plugin Custom Content Type Manager 0.9.5.13-pl - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/drag-drop-file-uploader/dnd-upload.php" \
        "id:5002781,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00420 - WordPress Plugin drag and drop file upload 0.1 - Arbitrary File Upload'"

SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/mac-dock-gallery/upload-file.php" \
        "id:5002782,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00419 - Wordpress Mac Photo Gallery 2.7 Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \0" "id:5002783,msg:'VT-2018-02503 Nginx 0.8.41-1.5.6 URI Processing SecURIty Bypass CVE-2013-4547',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Nginx',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \0" "id:5002784,msg:'VT-2018-02502 Nginx 0.6.x - Arbitrary Code Execution NullByte Injection',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Nginx',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/uploader/uploadify/uploadify.php" \
	"id:5002785,chain,msg:'VT-2018-00523 WordPress Plugin Uploader - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/advanced-custom-fields/core/actions/export.php" \
	"id:5002786,chain,msg:'VT-2018-00522 WordPress Plugin Advanced Custom Fields - Remote File Inclusion (Metasploit)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:/^acf[\s\.\[_]abspath$/ "@contains \x00 :" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/asset-manager/upload.php" \
	"id:5002787,chain,msg:'VT-2018-00516 WordPress Plugin Asset-Manager - Arbitrary .PHP File Upload (Metasploit)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/pica-photo-gallery/upload-file.php" \
        "id:5002788,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00418 WordPress Plugin Pica Photo Gallery 1.0 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule ARGS:option "@streq com_users" \
	"id:5002789,chain,msg:'VT-2018-02176 Joomla! <= 2.5.2 - Admin Creation (CVE-2012-1563)',deny,status:403,log,t:none,t:urlDecodeUni,t:lowercase,rev:1,severity:2"
SecRule ARGS_POST:task "registration\.register" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS_POST:/^jform\[groups\]\[\]$/ "^[0-9]$" \
	"t:none,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains component/users/" \
	"id:5002790,chain,msg:'VT-2018-02176 Joomla! <= 2.5.2 - Admin Creation (CVE-2012-1563)',deny,status:403,log,t:none,t:urlDecodeUni,t:lowercase,t:normalizePathWin,rev:1,severity:2"
SecRule ARGS_POST:task "registration\.register" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS_POST:/^jform\[groups\]\[\]$/ "^[0-9]$" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:user-agent|REQUEST_HEADERS:x-forwarded-for "@rx [oO]:\+?\d" \
    "id:5002791,msg:'VT-2018-02159 Joomla! 1.5 < 3.4.5 - Object Injection x-forwarded-for Header Remote Code Execution CVE-2015-8562,CVE-2015-8566',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF_MONITOR_VUL',tag:'Joomla',tag:'VTWAF',setvar:tx.restrict_rule=1"
SecRule ARGS:highlight "@rx O:\+?\d+:" "id:5002792,msg:'VT-2018-02103 Joomla! 3.0.2 - highlight.php PHP Object Injection CVE-2013-1453',phase:2,deny,status:403,log,t:base64decode,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla',setvar:tx.restrict_rule=1"
SecRule ARGS:option "@streq com_content" "id:5002794,chain,msg:'VT-2018-02055 Joomla! 2.5.0 < 2.5.1 - Blind SQL Injection',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:view "@streq article" \
	"chain,t:none,t:trim,t:lowercase"
SecRule ARGS:id "@rx [^0-9]" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /aspell.php" \
	"id:5002795,chain,msg:'VT-2018-02822: Zimbra - aspell.php Cross-Site Scripting',phase:1,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule ARGS_GET:dictionary "!@rx ^(\w+|\w+_\w+|\w+_\w+_\w+)$"  \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /zimbra/h/calendar" \
	"id:5002796,chain,msg:'VT-2018-02821: Zimbra Web Client in Zimbra Collaboration Suite (ZCS) 6.x before 6.0.15 and 7.x before 7.1.3 allows remote attackers to inject arbitrary web script or HTML via the view parameter.',phase:1,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule ARGS_GET:view "!@rx ^(\w)+$"  \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /zimbraadmin/res/" \
	"id:5002797,chain,msg:'VT-2018-02823: Zimbra Collaboration Server 7.2.2 and 8.0.2 allows remote attackers to read arbitrary files via a .. (dot dot) in the skin parameter',phase:1,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule ARGS_GET:skin "!@rx ^(\w)+$"  \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /modules/mod_jfancy/script.php" \
	"id:5002798,chain,msg:'VT-2018-02070 Joomla! Component mod_jfancy - script.php - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /createitem" "id:5002799,chain,phase:1,pass,nolog,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,t:normalizePathWin,t:lowercase,msg:'VT-2018-02887-Set request body processor to be URLENCODED'"
SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "chain,t:none,t:lowercase"
SecRule ARGS:name "@rx (.+)" "t:none,t:urlDecodeUni,t:lowercase,setvar:'TX.jenkins_xml=1',ctl:requestBodyProcessor=URLENCODED"

SecRule TX:jenkins_xml "@eq 1" "id:5002800,chain,phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,msg:'VT-2018-02887-Jenkins XStream Groovy classpath Deserialization (CVE-2016-0792)'"
SecRule REQUEST_BODY "@rx (groovy\.util\.expando|java\.lang\.processbuilder)" "t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /cli" "id:5002801,chain,phase:1,pass,setvar:'TX.jenkins_xml=1',nolog,ctl:requestBodyProcessor=URLENCODED,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,t:normalizePathWin,t:lowercase,msg:'VT-2018-02886-Set request body processor to be URLENCODED'"
SecRule REQUEST_HEADERS:Content-Type "@within application/octet-stream" "t:none,t:lowercase,setvar:'TX.jenkins_xml=1',ctl:requestBodyProcessor=URLENCODED"

SecRule TX:jenkins_xml "@eq 1" "id:5002802,chain,phase:2,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',t:none,msg:'VT-2018-02886-CloudBees Jenkins Unauthenticated Code Execution (CVE-2017-1000353)'"
SecRule REQUEST_BODY "@rx (org\.apache\.commons\.collections\.map\.referencemap|org\.apache\.commons\.collections\.functors\.constanttransformer|java\.lang\.runtime|org\.apache\.commons\.collections\.functors\.invokertransformer)" "t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains  javax.faces.resource/dynamiccontent.properties.xhtml" \
	"id:5002803,chain,msg:'VT-2018-02818 Primefaces 5.x - Remote Code Execution CVE-2017-1000486',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'PrimeFaces'"
SecRule ARGS:pfdrt "@streq sc" "chain, t:none,t:lowercase"
SecRule ARGS:pfdrid "@gt 20" "t:none,t:trim,t:length,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx (redirect:|redirectAction:|action:)" \
	"id:5002804,chain,msg:'VT-2018-02839 RCE  Apache Struts 2.0.0 - 2.3.15 (CVE-2013-2251)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule REQUEST_URI "@contains #_memberAccess" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx redirect.*?:http" \
	"id:5002805,msg:'VT-2018-02838 Open Redirect  Apache Struts 2.0.0 - 2.3.15 (CVE-2013-2248)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /xmlrpc/pingback" \
	"id:5002806,chain,msg:'VT-2018-02791 Set request body processor to be XML',phase:1,pass,nolog,ctl:requestBodyProcessor=XML,t:none,t:trim,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay'"
SecRule REQUEST_METHOD "^POST$" \
	"t:none,t:trim"

SecRule REQUEST_FILENAME "@contains /xmlrpc/pingback" \
	"id:5002807,chain,msg:'VT-2018-02791 Liferay Portal lt 7.0.4 - Server-Side Request Forgery',phase:2,deny,log,status:403,t:none,t:trim,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay'"
SecRule REQUEST_METHOD "^POST$" \
	"chain,t:none,t:trim"
SecRule XML:/methodCall/methodName/text() "^pingback.ping$" \
         "chain,t:none,t:trim,t:lowercase"
SecRule XML:/methodCall/params/param/value/text() "@rx 127\.0\.0\.1|192\.168\.([0-9]{1,2}|[0-2][0-5]{2})\.([0-9]{1,2}|[0-2][0-5]{2})|172\.([1][6-9]|[2][0-9]|[3][0-1])\.([0-9]{1,2}|[0-2][0-5]{2})\.([0-9]{1,2}|[0-2][0-5]{2})|10\.([0-9]{1,2}|[0-2][0-5]{2})\.([0-9]{1,2}|[0-2][0-5]{2})\.([0-9]{1,2}|[0-2][0-5]{2})" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
        "id:5002808,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00675 - WordPress WPTouch Authenticated File Upload'"

SecRule ARGS:action "@eq upload_file" \
        "chain,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni"

SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/foxypress/uploadify/uploadify.php" \
        "id:5002809,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00423 - WordPress Plugin Foxypress - \'Uploadify.php\' Arbitrary Code Execution (Metasploit)'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/sfbrowser/connectors/php/sfbrowser.php" \
        "id:5002810,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00417 - WordPress Plugin SfBrowser 1.4.5 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html|ptxt)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/user-meta/framework/helper/uploader.php" \
        "id:5002811,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00415 - WordPress Plugin User Meta 1.1.1 - Arbitrary File Upload'"

SecRule REQUEST_METHOD "^(POST|PUT)$" \
        "chain,\
        t:none"

SecRule MULTIPART_FILENAME|ARGS:qqfile "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/wp-gpx-maps/wp-gpx-maps_admin_tracks.php" \
        "id:5002812,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00414 - WordPress Plugin wp-gpx-map 1.1.21 - Arbitrary File Upload - (CVE-2012-6649)'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/content-flow3d/shortcode/upload.php" \
        "id:5002813,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00413 - WordPress Plugin Content Flow 3D 1.0.0 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/front-file-manager/upload.php" \
        "id:5002814,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00404 - WordPress Plugin Front File Manager 0.1 - Arbitrary File Upload'"
SecRule ARGS:name "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/fcchat/html/upload.php?id=1" \
        "id:5002815,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00403 - WordPress Plugin FCChat Widget 2.2.x - \'upload.php\' Arbitrary File Upload - (CVE-2012-3578)'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/front-file-manager/upload.php" \
        "id:5002816,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00400 - WordPress Plugin Omni Secure Files 0.1.13 - Arbitrary File Upload'"
SecRule ARGS:name "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/gallery-plugin/upload/php.php" \
        "id:5002817,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00398 - WordPress Plugin Gallery 3.06 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-content/plugins/font-uploader/font-upload.php" \
        "id:5002818,\
        log,\
        status:403,\
        rev:1,\
        severity:2,\
        phase:2,\
        deny,\
        chain,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'wordpress',\
        tag:'plugin',\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        t:normalizePathWin,\
        msg:'VT-2018-00396 - WordPress Plugin Font Uploader 1.2.4 - Arbitrary File Upload - (CVE-2012-3814)'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/infusionsoft/Infusionsoft/utilities/code_generator.php" \
	"id:5002819,chain,msg:'VT-2018-00711 WordPress Plugin InfusionSoft - Arbitrary File Upload (Metasploit)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:fileNamePattern "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/front-end-upload/destination.php" \
	"id:5002820,chain,msg:'VT-2018-00451 WordPress Plugin Front End Upload 0.5.4.4 - Arbitrary .PHP File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:name "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/lb-mixed-slideshow/libs/uploadify/upload.php" \
	"id:5002821,chain,msg:'VT-2018-00430 WordPress Plugin LB Mixed Slideshow - upload.php Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/zingiri-web-shop/fwkfor/ajax/uploadfilexd.php" \
	"id:5002822,chain,msg:'VT-2018-00426 WordPress Plugin Zingiri Web Shop 2.4.3 - uploadfilexd.php Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/monsters-editor-10-for-wp-super-edit/mse/fckeditor/editor/filemanager/upload/php/upload.php" \
	"id:5002823,chain,msg:'VT-2018-00462 WordPress Plugin Monsters Editor for WP Super Edit - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Cookie "@gt 5000" \
	"id:5002824,msg:'VT-2018-02637: Apache 2.2.x-2.2.21 HTTP Only Disclosure',phase:1,deny,status:403,log,t:none,t:trim,t:length,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Apache2',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/richfaces\/renderkit\/html\/css\/extended_classes\.xcss\/data" \
	"id:5002825,chain,phase:1,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Richfaces',t:none,t:normalizePathWin,t:lowercase,msg:'VT-2018-02468-RichFaces: Injection of arbitrary EL expressions allows remote code execution via org.richfaces.renderkit.html.Paint2DResource (CVE-2018-12533,CVE-2013-2165)'"
SecRule REQUEST_FILENAME "!@rx \/richfaces\/renderkit\/html\/css\/extended_classes\.xcss\/data\/(.){50}" \
	"t:none,t:normalizePathWin,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /org.richfaces.resource.mediaoutputresource" "id:5002826,phase:1,deny,status:403,log,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Richfaces',t:none,t:normalizePathWin,t:lowercase,msg:'VT-2018-02467-RichFaces: Injection of arbitrary EL variable mapper allows to bypass mitigation of CVE-2015-0279 and thereby remote code execution (CVE-2018-12532)',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /modules/mod_artuploader/upload.php" \
	"id:5002827,chain,msg:'VT-2018-02066 Joomla! Component mod_artuploader - Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule REQUEST_METHOD "^POST$" "chain,t:none"
SecRule FILES "@rx (?i:\.(php.?|html|shtml|phtml|htaccess))" "t:none,,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx -[dtcnbsh?](\s|$)" \
    "id:5002828,\
    deny,\
    status:403,\
    phase:2,\
    rev:1,\
    severity:2,\
    log,\
    tag:'VTWAF',\
    tag:'VTWAF_MONITOR_VUL',\
    tag:'Apache',\
    tag:'PHP',\
    t:none,\
    t:lowercase,\
    t:trim,\
    t:urlDecodeUni,\
    t:urlDecode,\
    t:removeNulls,\
    msg:'VT-2018-02641 Apache + PHP < 5.3.12 / < 5.4.2 - cgi-bin Remote Code Execution (CVE-2012-1823,CVE-2012-2311,CVE-2012-2336)',\
    setvar:tx.restrict_rule=1"
SecRule REQUEST_COOKIES_NAMES "@rx (java.io|#_memberAccess)" \
	"id:5002829,msg:'VT-2018-02891 Remote command execution in Struts <= 2.3.1 (CookieInterceptor) (CVE-2012-0392)',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS:debug "@rx command" \
	"id:5002830,msg:'VT-2018-02893 Remote command execution in Struts <= 2.3.1 (DebuggingInterceptor) (CVE-2012-03934)',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx (java.io.FileWriter)" \
	"id:5002831,msg:'VT-2018-02892 Arbitrary File Overwrite in Struts <= 2.3.1 (ParametersInterceptor) (CVE-2012-0393)',phase:2,deny,status:403,log,t:none,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_GET_NAMES  "@rx (class\[\'classloader\'\]|class\.classloader)" \
	"id:5002832,msg:'VT-2018-02842 RCE Struts 2.0.0 - Struts 2.3.16.1 (CVE-2014-0094, CVE-2014-0112, CVE-2014-0113)',phase:2,deny,status:403,log,t:none,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS_GET_NAMES  "@rx (class\[\'classloader\'\]|class\.classloader)" \
	"id:5002833,msg:'VT-2018-02841 RCE Struts <= 1.3.10 (CVE-2014-0114)',phase:2,deny,status:403,log,t:none,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-admin/admin-ajax.php" \
	"id:5002834,chain,msg:'VT-2018-00715 WordPress Plugin Photo Gallery 1.2.5 - Unrestricted Arbitrary File Upload',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS "@contains bwg_uploadhandler" \
	"t:none,t:trim,t:urlDecode,t:lowercase,chain"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@contains /wp-admin/admin-ajax.php" \
	"id:5002835,chain,msg:'VT-2018-00801 WordPress Plugin RevSlider 3.0.95 - Arbitrary File Upload / Execution (Metasploit) CVE-2014-9735 ',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:/^client[\s\.\[_]action$/ "@contains update_plugin_lang" \
	"t:none,t:trim,t:urlDecode,chain"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wp-content/plugins/wp-symposium/server/php/" \
	"id:5002836,chain,msg:'VT-2018-00734 WordPress Plugin WP Symposium 14.11 - Arbitrary File Upload (Metasploit)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule FILES "@rx \.(php|phtml|php3|php4|php5|php7|phps|htaccess|shtml)" \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_POST:action "@contains wpdm_ajax_call" \
	"id:5002837,chain,msg:'VT-2018-00733 WordPress Plugin Download Manager 2.7.4 - Remote Code Execution',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:execute "!@beginsWith wpdm_getlink" \
	"t:none,t:urlDecode,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-login.php" \
	"id:5002838,chain,msg:'VT-2018-00726 WordPress < 4.0.1 - Denial of Service CVE-2014-9034',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_POST:pwd "@gt 100" \
	"t:none,t:trim,t:lowercase,t:length,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-easycart/inc/amfphp/administration/banneruploaderscript.php"\
		"id:5002839,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00740 - WordPress Plugin WP EasyCart - Unrestricted Arbitrary File Upload (CVE-2014-9308)'"
SecRule ARGS_NAMES "datemd5"\
		"chain,t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx .*wp-admin\/(admin-post|admin-ajax)\.php"\
		"id:5002840,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00739 - WordPress Platform Theme File Upload Vulnerability'"
SecRule ARGS:/^settings[\s\.\[_]upload$/ "@contains settings"\
		"chain,t:none,\
		t:lowercase"
SecRule ARGS:page "@contains pagelines"\
		"chain,t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@contains settings"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx cf[\s\.\[_](working|failure|codeerr|customerr|popup)"\
		"id:5002841,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		msg:'VT-2018-00737 - WordPress Plugin Cforms 14.7 - Unsafe File Upload (CVE-2014-9473)'"
SecRule FILES_NAMES "@rx cf[\s\.\[_]uploadfile"\
		"chain,\
		t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx (pixabay[\s\.\[_]upload|image[\s\.\[_]user|q)"\
		"id:5002842,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		msg:'VT-2018-00736 - WordPress Pixabay Images - PHP Code Upload (CVE-2015-1376)'"
SecRule ARGS:/^image[\s\.\[_]url$/ "!@rx ^https?://pixabay\.com/.*\.(jpg|png|gif)$"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /inboundio-marketing/admin/partials/csv_uploader.php"\
		"id:5002843,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00757 - WordPress Plugin InBoundio Marketing 1.0 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /wpshop/includes/ajax.php"\
		"id:5002844,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00754 - WordPress Plugin WPshop eCommerce Arbitrary - Arbitrary File Upload'"
SecRule ARGS:elementCode "@contains ajaxupload"\
		"chain,t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains reflex-gallery/admin/scripts/fileuploader/php.php"\
		"id:5002845,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00753 - WordPress Plugin Reflex Gallery 3.1.3 - Arbitrary File Upload'"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /admin/upload-file.php"\
		"id:5002846,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00752 - WordPress Theme DesignFolio Plus 1.2 - Arbitrary File Upload'"
SecRule ARGS_NAMES "upload[\s\.\[_]path"\
		"chain,t:none,\
		t:lowercase"
SecRule REQUEST_FILENAME "@contains designfolio"\
		"chain,t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /admin/upload-file.php"\
		"id:5002847,\
		deny,chain,status:403,log,rev:1,severity:2,\
		phase:2,\
		tag:'VTWAF',\
		tag:'VTWAF_MONITOR_VUL',\
		tag:'Wordpress',\
		t:none,\
		t:lowercase,\
		t:normalizePathWin,\
		msg:'VT-2018-00742 - WordPress Theme Holding Pattern - Arbitrary File Upload - CVE-2015-1172'"
SecRule ARGS_NAMES "upload[\s\.\[_]path"\
		"chain,t:none,\
		t:lowercase"
SecRule REQUEST_FILENAME "@contains holding"\
		"chain,t:none,\
		t:lowercase"
SecRule MULTIPART_FILENAME "@rx \.(php.?|htaccess|shtml|phtml|html)"\
		"t:none,\
		t:lowercase,\
		setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:if "(?i:(^<http(s?):))" "phase:2,rev:2,t:none,t:urlDecodeUni,log,deny,status:403,msg:'VT-2018-02733 Microsoft IIS - WebDav ScStoragePathFromUrl Remote Overflow (Metasploit) CVE-2017-7269',id:5002848,logdata:'Found %{matched_var} in header',severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "\~|\*" \
        "id:5002849,\
        msg:'VT-2018-02732 Microsoft IIS - Short File/Folder Name Disclosure',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx :.*:\$index_allocation" \
        "id:5002850,\
        msg:'VT-2018-02731 Microsoft IIS 6.0/7.5 (+ PHP) - Multiple Vulnerabilities - Bypass Authentication',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',\
        setvar:tx.restrict_rule=1"
        
SecRule REQUEST_FILENAME "@rx \/\.php" \
        "id:5002851,\
        msg:'VT-2018-02731 Microsoft IIS 6.0/7.5 (+ PHP) - Multiple Vulnerabilities - Source code disclosure',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains msadcs.dll/advanceddatafactory.query" \
        "id:5002852,\
        msg:'VT-2018-02730 Microsoft IIS - MDAC msadcs.dll RDS DataStub Content-Type Overflow (CVE-2002-1142)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'IIS',\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (\/service\/soap\/*|\/service\/autodiscover)" \
	"id:5002853,chain,msg:'VT-2018-02825 Set request body processor to be URLENCODED',phase:1,pass,nolog,t:none,t:trim,t:normalizePathWin,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule REQUEST_METHOD "^POST$" \
	"t:none,t:trim,ctl:requestBodyProcessor=URLENCODED"

SecRule REQUEST_FILENAME "@rx (\/service\/soap\/*|\/service\/autodiscover)" \
	"id:5002854,chain,msg:'VT-2018-02825: Zimbra Collaboration Suite (ZCS) before 8.7.4 allows remote attackers to conduct XML External Entity (XXE) attacks.',phase:2,deny,status:403,log,t:none,t:trim,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule REQUEST_BODY "<!ENTITY\s+.+\s+SYSTEM\s" \
	"t:none,t:htmlEntityDecode,t:lowercase,setvar:tx.restrict_rule=1"
SecRule ARGS_NAMES "@rx (\[\(|\(\[|\]\(|\)\])" "id:5002855,chain,msg:'VT-2018-02835 ParameterInterceptor vulnerability allows remote command execution (CVE-2011-3923)',phase:2,deny,status:403,log,rev:1,severity:2,t:none,t:urlDecodeUni,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts'"
SecRule ARGS "@contains xwork.methodaccessor.denymethodexecution" "t:none,t:urlDecodeuni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains skill/save.action" "id:5002856,chain,phase:2,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',t:none,t:normalizePathWin,t:lowercase,rev:1,severity:2,msg:'VT-2018-02834-Apache Struts 2 - Skill Name Remote Code Execution'"
SecRule REQUEST_BODY "@rx (?i:(memberAccess|xwork.MethodAccessor.denyMethodExecution|allowStaticMethodAccess|java.lang.Runtime))" "t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx (?i:(#_memberAccess|allowStaticMethodAccess|java\.lang\.Runtime))" "id:5002857,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',t:none,t:lowercase,rev:1,severity:2,msg:'VT-2018-02833-Apache Struts 2.2.1.1 Remote Command Execution (CVE-2012-0391)'"
SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "id:5002858,chain,msg:'VT-2018-02765 Set request body processor to be XML',phase:1,pass,nolog,t:none,t:trim,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Websphere'"
SecRule REQUEST_METHOD "^POST$" \
	"t:none,t:trim,ctl:requestBodyProcessor=XML"

SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "id:5002859,chain,phase:2,deny,status:403,log,t:none,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Websphere',msg:'VT-2018-02765 IBM WebSphere - RCE Java Deserialization (Metasploit) CVE-2015-7450',rev:1,severity:2"
SecRule REQUEST_METHOD "^POST$" "chain,t:none,t:trim"
SecRule XML:/SOAP-ENV:Envelope/SOAP-ENV:Body/objectname/text() "@contains  org.apache.commons.collections.functors.InvokerTransformer" \
	"t:none,t:trim,t:base64Decode,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /reports/rwservlet" \
	"id:5002860,msg:'Set request body processor to be URLENCODED',phase:1,pass,nolog,t:none,t:trim,t:lowercase,ctl:requestBodyProcessor=URLENCODED,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle'"

SecRule REQUEST_FILENAME "@contains /reports/rwservlet" \
	"id:5002861,chain,msg:'VT-2018-02875 Oracle Fusion Middleware 11.1.1.4, 11.1.1.6, and 11.1.2.0 arbitrary files upload,CVE-2012-3152',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle',tag:'Oracle reports'"
SecRule &ARGS:destype "@ge 1" \
	"chain,t:none"
SecRule &ARGS:jobtype "@ge 1" \
	"chain,t:none"
SecRule ARGS:URLPARAMETER "!@rx (\"|\')?(http|ftp)s?:\/\/" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains /reports/rwservlet" \
	"id:5002862,chain,msg:'VT-2018-02875 Oracle Fusion Middleware 11.1.1.4, 11.1.1.6, and 11.1.2.0 arbitrary files upload,CVE-2012-3152',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle',tag:'Oracle reports'"
SecRule &ARGS:destype "@ge 1" \
	"chain,t:none"
SecRule &ARGS:URLPARAMETER "@ge 1" \
	"chain,t:none"
SecRule &ARGS:jobtype "@ge 1" \
	"chain,t:none"
SecRule ARGS:desname "@rx \.jsp" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
	
SecRule REQUEST_FILENAME "@contains /reports/rwservlet" \
	"id:5002863,chain,msg:'VT-2018-02875 Oracle Fusion Middleware 11.1.1.4, 11.1.1.6, and 11.1.2.0 arbitrary files upload,CVE-2012-3152',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle',tag:'Oracle reports'"
SecRule REQUEST_URI|REQUEST_BODY "@rx destype=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI|REQUEST_BODY "@rx urlparameter=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI|REQUEST_BODY "@rx jobtype=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI|REQUEST_BODY "@rx desname=[^=]*?\.jsp" \
	"t:none,t:urlDecodeUni,t:lowercase,setvar:tx.restrict_rule=1"
	
SecRule REQUEST_FILENAME "@contains /reports/rwservlet" \
	"id:5002864,chain,msg:'VT-2018-02875 Oracle Fusion Middleware 11.1.1.4, 11.1.1.6, and 11.1.2.0 arbitrary files upload,CVE-2012-3152',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle',tag:'Oracle reports'"
SecRule REQUEST_URI "@rx destype=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI "@rx jobtype=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI "@rx urlparameter=" \
	"chain,t:none,t:urlDecodeUni,t:lowercase"
SecRule REQUEST_URI "!@rx (?i:(urlparameter=[\'\"]*?(http)s?:\/\/))" \
	"t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /portal/!ut/p/b1/" \
        "id:5002865,\
        msg:'VT-2018-02763 IBM Websphere Portal - Persistent Cross-Site Scripting (CVE-2014-0910)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:normalizePathWin,\
        t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Websphere'"

SecRule ARGS "@rx (<.*on\S+)(\s*)=|javascript[^a-zA-Z0-9]*\:|(<\s*)(\/*)(script|noscript)" \
        "t:none,t:trim,t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /reports/rwservlet/showenv" \
"id:5002866,msg:'VT-2018-02874 Oracle Fusion Middleware 11.1.1.4, 11.1.1.6, and 11.1.2.0 information disclosure,CVE-2012-3153',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Oracle',tag:'Oracle reports',setvar:tx.restrict_rule=1"
SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "id:5002867,chain,msg:'VT-2018-2764 Set request body processor to be XML',phase:1,pass,nolog,t:none,t:trim,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Websphere'"
SecRule REQUEST_METHOD "^POST$" \
	"t:none,t:trim,ctl:requestBodyProcessor=XML"

SecRule REQUEST_HEADERS:Content-Type "@within text/xml application/xml" "id:5002868,chain,phase:2,deny,status:403,log,t:none,t:lowercase,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Websphere',msg:'VT-2018-2764 Websphere/JBoss/OpenNMS/Symantec Endpoint Protection Manager - Java Deserialization Remote Code Execution CVE-2015-4852',rev:1,severity:2"
SecRule REQUEST_METHOD "^POST$" "chain,t:none,t:trim"
SecRule XML:/SOAP-ENV:Envelope/SOAP-ENV:Body/params/text() "@contains  org.apache.commons.collections.functors.InvokerTransformer" \
	"t:none,t:trim,t:base64Decode,setvar:tx.restrict_rule=1"
SecRule ARGS "@rx (\${.*})" \
	"id:5002869,msg:'VT-2018-02836 RCE in Struts 2.0.0 - 2.3.14.1 CVE-2013-2115, CVE-2013-1966',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx (\${.*})" \
	"id:5002870,msg:'VT-2018-02837 RCE Struts 2.0.0 - 2.3.14.2 (CVE-2013-2134)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Struts',setvar:tx.restrict_rule=1"
SecRule ARGS:__VIEWSTATE "@contains ActivitySurrogateSelector" \
	"id:5002871,msg:'VT-2018-02741 Exchange MAC Disabled Vulnerability',phase:2,deny,status:403,log,t:none,t:trim,t:Base64Decode,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Exchange',setvar:tx.restrict_rule=1"
SecRule ARGS:__VIEWSTATE "@contains ActivitySurrogateSelector" \
	"id:5002872,msg:'VT-2018-02741 Sharepoint MAC Disabled Vulnerability',phase:2,deny,status:403,log,t:none,t:trim,t:Base64Decode,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Sharepoint',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains wp-admin/admin.php" \
	"id:5002874,chain,msg:'VT-2018-02897 - WordPress Design Flaw Leads to WooCommerce RCE',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS_GET:page "@eq wc-status" \
	"t:none,t:trim,t:urlDecode,t:lowercase,chain"
SecRule ARGS_GET:handle "@contains .." \
	"t:none,t:trim,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/solr\/.*\/select" \
        "id:5002891,\
        msg:'VT-2019-00171 Solr XXE (CVE-2017-12629)',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Solr XXE'"

SecRule ARGS:q "@rx \{.*(\!|deftype).*(xmlparser|system|doctype|\'|\"|\<|\(|\)|\[|\]|\!).*\}" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"
SecRule ARGS:_format "@streq hal_json" \
	"id:5002892,msg:'VT-2019-00176 Some field types do not properly sanitize data from non-form sources in Drupal 8.5.x before 8.5.11 and Drupal 8.6.x before 8.6.10. This can lead to arbitrary PHP code execution in some cases. (CVE-2019-6340)',phase:2,pass,nolog,t:none,t:trim,t:lowercase,ctl:forceRequestBodyVariable=On,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Drupal'"
    
SecRule ARGS:_format "@streq hal_json" \
	"id:5002893,chain,msg:'VT-2019-00176 Some field types do not properly sanitize data from non-form sources in Drupal 8.5.x before 8.5.11 and Drupal 8.6.x before 8.6.10. This can lead to arbitrary PHP code execution in some cases. (CVE-2019-6340)',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Drupal'"
SecRule REQUEST_BODY "@rx O:\+?\d+:.+" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /service/v4/rest.php" \
	"id:5002875,chain,msg:'VT-2019-00166 SugarRestSerialize.php PHP Object Injection Vulnerability KIS-2016-07',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'SugarCRM'"

SecRule ARGS:/^rest[\s\.\[_]data$/ "@contains \00*\00" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /_vti_bin/webpartpages.asmx" \
	"id:5002876,msg:'VT-2019-00020 Set request body processor to be URLENCODED',phase:1,pass,nolog,t:none,t:lowercase,t:normalizePathWin,ctl:requestBodyProcessor=URLENCODED,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'SharePoint'"

SecRule REQUEST_FILENAME "@contains /_vti_bin/webpartpages.asmx" \
	"id:5002877,chain,msg:'VT-2019-00020 Bypassing Microsoft XOML Workflows Protection Mechanisms using Deserialisation of Untrusted Data RCE CVE-2018-8421',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'SharePoint'"

SecRule REQUEST_BODY "@contains clr-namespace:System" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains administrator"\
	"id:5002878,chain,msg:'VT-2019-00090 - Joomla - Second Order SQL Injection - CVE-2018-6376',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:option "@streq com_admin" "chain,t:none,t:trim,t:lowercase"
SecRule ARGS:task "@streq profile.apply" "chain,t:none,t:trim,t:lowercase"
SecRule ARGS:jform[params][admin_style][] "@rx [^\w]" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains administrator"\
	"id:5002879,chain,msg:'VT-2019-00090 - Joomla - Second Order SQL Injection - CVE-2018-6376',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:option "@streq com_admin" "chain,t:none,t:trim,t:lowercase"
SecRule ARGS:task "@streq profile.apply" "chain,t:none,t:trim,t:lowercase"
SecRule ARGS:jform[params][admin_style][0] "@rx [^\w]" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains administrator"\
	"id:5002880,chain,msg:'VT-2019-00086 - Joomla - SQL injection vulnerability 3.x before 3.4.7 - CVE-2015-8769',phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,t:urlDecodeUni,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Joomla'"
SecRule ARGS:option "@streq com_categories" "chain,t:none,t:trim,t:lowercase"
SecRule ARGS:jform[extension] "@streq com_content" "chain,t:none,t:trim,t:lowercase,t:urlDecodeUni"
SecRule ARGS:task "@streq category.apply" "chain,t:none,t:trim,t:lowercase,t:urlDecodeUni"
SecRule ARGS:/jform\[associations\]\[.*\]/ "@rx [^\w\*]" "t:none,t:urlDecodeUni,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /jbossmq-httpil/httpserverilservlet" \
	"id:5002881,msg:'VT-2019-00071 - Jboss CVE-2017-7504 Java Deserialization (CVE-2017-7504)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jboss',setvar:tx.restrict_rule=1"
#SecRule ARGS "@rx (%[1-9]\$)|(%s)" "id:5002882,msg:'VT-2019-00159 WordPress <= 4.8.2 (CVE-2017-16510)',phase:2,deny,status:403,log,t:none,t:trim,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (\/ws_utc\/resources\/setting\/keystore|\/ws_utc\/resources\/ws\/config\/import)" \
        "id:5002883,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:normalizePathWin,\
        t:urlDecodeUni,\
        msg:'VT-2019-00148 - WebLogic Unrestricted File Upload Lead To RCE Check Script - (CVE-2018-2894)'"
SecRule MULTIPART_FILENAME "@rx \.(jsp|jsf|xhtm|xhtml|html|htaccess|jspx)$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
#########################################################################
# VT-2019-00106
# Roundcube 1.2.0-1.3.5 mx injection
# only allow _uid is number
SecRule ARGS:/^[\s\.\[_]action$/ "@contains plugin.move2archive" \
        "id:5002884,\
        rev:1,\
        status:403,\
        severity:2,\
        log,\
        tag:'VTWAF',\
        tag:'VTWAF_MONITOR_VUL',\
        tag:'Roundcube',\
        phase:2,\
        chain,\
        deny,\
        t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        msg:'VT-2019-00106 - Roundcube 1.2.0-1.3.5 mx injection - (CVE-2018-9846)'"
SecRule ARGS:/^[\s\.\[_]uid$/ "!@rx ^[0-9]+$" \
        "t:none,\
        t:lowercase,\
        t:urlDecodeUni,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains import.php" "id:5002885,msg:'VT-2019-000098 phpMyAdmin unserialize() Function RCE Vulnerability (CVE-2016-6620)',chain,phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'phpMyAdmin'"
SecRule ARGS:/^sql[\s\.\[_]query$/|ARGS:db "@contains phpmyadmin" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:/^sql[\s\.\[_]query$/ "@contains pma__tracking" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:/^sql[\s\.\[_]query$/ "@contains schema_snapshot" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:/^sql[\s\.\[_]query$/ "O:\+?\d+:.*" "t:none,t:urlDecodeUni,t:trim,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@contains tbl_replace.php""id:5002886,msg:'VT-2019-000098 phpMyAdmin unserialize() Function RCE Vulnerability (CVE-2016-6629)',chain,phase:2,deny,status:403,log,t:none,t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'phpMyAdmin'"
SecRule ARGS:db "@streq phpmyadmin" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:table "@streq pma__tracking" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:/fields[\s\.\[_]name\[multi_edit\]/ "schema_snapshot" "chain,t:none,t:urlDecodeUni,t:trim,t:lowercase"
SecRule ARGS:/fields\[multi_edit\]/ "O:\+?\d+:.*" "t:none,t:urlDecodeUni,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/api[\/\\\]{1,}liferay" "id:5002887,chain,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay',t:none,t:normalizePathWin,t:lowercase,rev:1,severity:2,msg:'VT-2019-00163-Liferay: Liferay TunnelServlet Deserialization Remote Code Execution'"
SecRule REQUEST_METHOD "@within POST" "t:none,setvar:tx.restrict_rule=1"

SecRule REQUEST_FILENAME "@rx \/api[\/\\\]{1,}spring" "id:5002888,chain,phase:1,deny,status:403,log,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Liferay',t:none,t:normalizePathWin,t:lowercase,rev:1,severity:2,msg:'VT-2019-00163-Liferay: Liferay TunnelServlet Deserialization Remote Code Execution'"
SecRule REQUEST_METHOD "@within POST" "t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/admin\/admin\/widget\/index\/(key\/[a-z0-9A-Z]+\/)?widget_target_id" \
        "id:5002889,\
        msg:'VT-2019-00168 Magento Commerce Widget Form (Core) XSS Vulnerability',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule REQUEST_FILENAME  "!@rx ^[a-zA-Z0-9\/\_\.\-]+$" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"


SecRule REQUEST_FILENAME "@rx \/admin\/admin\/widget\/index\/(key\/[a-z0-9A-Z]+\/)?" \
        "id:5002890,\
        msg:'VT-2019-00168 Magento Commerce Widget Form (Core) XSS Vulnerability',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS:/^widget[\s\.\[_]target[\s\.\[_]id$/ "!@rx ^[a-zA-Z0-9\/\_\.\-]+$" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/admin\/admin\/email_template\/save" \
        "id:5002894,\
        msg:'VT-2019-00169 Magento Local File Read',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule ARGS:/^template[\s\.\[_]text$/ "@rx \{\{.*file.*\.\..*\}\}" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/checkout\/cart\/add" \
        "id:5002895,\
        msg:'VT-2019-00170 Magento Remote Code Execution',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento'"

SecRule FILES_NAMES "@rx ^options[\s_\[\.]+.*[\s_\[\.]+file$"\
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        chain"

SecRule MULTIPART_FILENAME "@rx \.(phtml|php|htaccess|shtml|html)"\
        "t:none,\
        t:lowercase,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx \/solr\/.*\/select" \
        "id:5002896 ,\
        msg:'VT-2019-00171 Solr XXE',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Solr XXE'"

SecRule ARGS:q "@rx \{.*(\!|deftype).*(xmlparser|system|doctype|\'|\"|\<|\(|\)|\[|\]|\!).*\}" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "^.*/solr/[^/]*/config$" \
	"id:5002897,phase:1,t:none,pass,nolog,ctl:requestBodyProcessor=JSON"
SecRule ARGS:add-listener.class "@contains RunExecutableListener" \
	"id:5002898,msg:'VT-2019-00165 - Solr RCE (CVE-2017-12629)',phase:2,deny,status:403,log,rev:1,severity:2,t:none,setvar:tx.restrict_rule=1, tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Solr'"
SecRule REQUEST_FILENAME "@rx (/_layouts/picker\.aspx|/_layouts/15/picker\.aspx)" \
	"id:5002899,chain,msg:'VT-2019-00177 Sharepoint RCE (CVE-2019-0604)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Sharepoint'"
SecRule ARGS:PickerDialogType "@contains ItemPickerDialog" \
	"chain,t:none"
SecRule ARGS:ctl00$PlaceHolderDialogBodySection$ctl05$hiddenSpanData "@beginsWith __" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /autodiscover" \
	"id:5002901,msg:'VT-2019-00172 Zimbra Autodiscover XXE (CVE-2019-9670)',phase:2,pass,nolog,t:none,t:lowercase,ctl:forceRequestBodyVariable=On,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"

SecRule REQUEST_FILENAME "@contains /autodiscover" \
	"id:5002902,chain,msg:'VT-2019-00172 Zimbra Autodiscover XXE (CVE-2019-9670)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule REQUEST_BODY "@rx <!doctype\s*request" \
	"t:none,t:lowercase,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /proxy" \
	"id:5002903,chain,msg:'VT-2019-00173 Zimbra ProxyServlet SSRF (CVE-2019-9621)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Zimbra'"
SecRule ARGS:target "@rx .+" \
	"chain,t:none"
SecRule REQUEST_HEADERS:Host "@rx .*:7071" \
	"chain,t:none"
SecRule REQUEST_COOKIES:ZM_ADMIN_AUTH_TOKEN "@rx .+" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (\/catalog\/product_frontend_action\/synchronize|\/catalog\/product\/frontend_action_synchronize)" \
        "id:5002904,\
        msg:'VT-2019-00178 Magento SQLi',\
        phase:2,\
        deny,\
        status:403,\
        log,\
        chain,\
        t:none,\
        t:normalizePath,t:normalizePathWin,\
        t:trim,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Magento SQLi'"

SecRule ARGS:ids[0][product_id][from] "@rx .*\?.*" \
        "t:none,t:trim,t:lowercase,\
        t:urldecode,\
        setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@rx (?i:(\/wls-wsat\/CoordinatorPortType|\/_async\/AsyncResponseService))" \
	"id:5002900,msg:'VT-2019-00183 RCE in wls9_async_response and wls-wsat module (WebLogic)',phase:2,deny,status:403,log,t:none,t:normalizePath,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WebLogic',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-admin/admin-post.php" \
	"id:5002905,chain,msg:'VT-2019-00184 Social Warfare XSS and RCE Vulnerabilities and Attack Data (CVE-2019-9978)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:/^swp[\s\.\[_]debug$/ "@streq load_options" \
	"chain, t:none,t:lowercase,t:trim"
SecRule ARGS:/^swp[\s\.\[_]url$/ "@rx .+" \
	"t:none,t:lowercase,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@contains /securityrealm/user/admin/descriptorbyname/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.securegroovyscript/checkscript" \
	"id:5002907,msg:'VT-2019-00185 Remote command execution in Jenkins <= 2.153 (CVE-2018-1000861, CVE-2019-1003005, CVE-2019-1003029)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Jenkins',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME "@rx (\/cgi-bin\/|\/cgi\/).*\.(bat|vbs)" \
	"id:5002908,msg:'VT-2019-00184 Apache Tomcat Remote Code Execution on Windows (CVE-2019-0232)',phase:2,deny,status:403,log,t:none,t:lowercase,t:normalizePathWin,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Tomcat',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-admin/post.php" \
	"id:5002906,chain,msg:'VT-2019-00187 WordPress Core 5.0 - Remote Code Execution (CVE-2019-8943,CVE-2019-8942)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:/^[\s\.\[_]wpnonce$/ "@rx .+" \
	"chain, t:none,t:lowercase,t:trim"
SecRule ARGS:action "@contains editpost" \
	"chain, t:none,t:lowercase,t:trim"
SecRule ARGS:/^meta[\s\.\[_]input\[_wp_attached_file\]$/ "@rx \.\.[\\\/]" \
	"t:none,setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /secure/contactadministrators!default.jspa" \
	"id:5002911,msg:'VT-2019-00192 Atlassian Jira - Template injection (CVE-2019-11581)',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'Atlassian Jira',setvar:tx.restrict_rule=1"
SecRule REQUEST_FILENAME  "@contains /wp-admin/admin-ajax.php" \
	"id:5002909,chain,msg:'VT-2019-00190 Convert Plus WordPress plugin flaw allows hackers to create Admin accounts',phase:2,deny,status:403,log,t:none,t:urlDecodeUni,t:normalizePath,t:normalizePathWin,t:lowercase,rev:1,severity:2,tag:'VTWAF',tag:'VTWAF_MONITOR_VUL',tag:'WordPress'"
SecRule ARGS:action "@streq cp_add_subscriber" \
	"chain,t:none,t:lowercase,t:trim"
SecRule ARGS:/^cp[\s\.\[_]set[\s\.\[_]user$/ "!@streq None" \
	"chain,t:none,t:trim"
SecRule ARGS:param[email] "@rx .+" \
	"t:none,t:trim,setvar:tx.restrict_rule=1"
SecRule REQUEST_URI "@rx wp-admin\/admin.php" "id:5002910,chain,msg:'Yoast SEO 9.1 Vulnerability Could Allow Command Execution for WordPress (CVE-2018-19370)',phase:2,deny,status:403,log,t:none,rev:3,severity:2,tag:'VTWAF',tag:'WPPlugin',tag:'WordPress'"
SecRule ARGS_GET:tool "@contains import-export" "chain"
SecRule ARGS_GET:page "@contains wpseo_tools" "chain"
SecRule REQUEST_METHOD "^POST$" "t:none,setvar:tx.restrict_rule=1"
####################END GLOBAL RULE#####################
